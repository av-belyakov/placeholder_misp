#   Описание полей правил
# 
# 1. Поле 'actionType' может иметь одно из следующих значений: 'pass', 'passany', 'replace', 'reject'. Правила, идущие следующими в списке
# после правила с одним из типов 'pass' или 'passany' в поле 'actionType' НЕ ПРИМЕНЯЮТСЯ для последующей обработки.
#
# Например, если после правила с типом 'pass' в поле 'actionType' идет правило с типом 'replace' то такое правило не применяется для обработки 
# данного сообщения, так как по результатам обработки правила 'pass', сообщение будет либо пропущено либо отклонено. То же самое если правило типа
# 'passany', то все сообщения будут пропущены без дальнейшей обработки другими правилами. 
#
# Тип 'passany' ОСОБЕННЫЙ, при использовании правила этого типа пропускаются все сообщения без их дальнейшей обработки. При этом для правила
# с этим типом не нужно поле 'listRequiredValues', так как поля и их значения не учитываются.
# 
# 2. Поле 'listRequiredValues' используется для поиска полей и их значений, а так же содержит значения, на которые стоит заменить найденное значение 
# в поле (если 'actionType' содержит тип 'replace'). Поле 'listRequiredValues' содержит следующий перечень свойств:
#   - fieldName, наименование искомого поля (данное поле НЕ ОБЯЗАТЕЛЬНО для заполнения при 'actionType' = 'replace')
#   - typeValue, тип значения искомого поля, должно содержать одно из значений string, int, bool
#   - value, значение искомого поля, для обозначения пустого значения этого свойства (если тип значения искомого поля равен string) используйте
#     значение 'null'
#   - replaceValue, значение на которое нужно заменить, для обозначения пустого значения этого свойства (если тип значения искомого поля равен 
#     string) используйте значение 'null'
# Если в 'actionType' установленно значение 'replace', то 'listRequiredValues' на ряду со свойствами 'name', 'typeValue', 'value' должно
# содержать еще и свойство 'replaceValue'
#
#   ВНИМАНИЕ! 
# Правило, со значением 'replace' в поле 'actionType' само по себе не выполняет пропуск сообщения. После этого правила или их набора, 
# всегда должно идти правило, выполняющее пропуск сообщения. То есть правило со значением 'pass' или 'passany' в поле 'actionType'.
# Для правила со значением 'replace' в поле 'actionType' поле listRequiredValues.fieldName НЕ ОБЯЗАТЕЛЬНО для заполнение, если оно пустое
# то замена значения будет выполнятся в ЛЮБОМ поле, значение которого совпадает со значение в listRequiredValues.value.
#
#
# Правило, со значением 'reject' в поле 'actionType' отклоняет только те сообщения, которые совпадаю с искомым значением. Однако сообщения, которые
# не совпадают передаются на следующий уровень обработки и если в конце этой цепочки нет правила с типом 'pass' или 'passany' то сообщение так же
# будет отброшено.
# 
#   ВНИМАНИЕ!
# Логика обработки правил следующая:
# - для основных правил, где есть поле actionType применяется "ИЛИ"
# - для правил находящихся в списке listRequiredValues используется "И"
#

RULLES:
  - actionType: "replace"
    listRequiredValues:
      - fieldSearchName: "dataType"
        typeValue: "string"
        findValue: "arkime"
        replaceValue: ""
      - fieldSearchName: "dataType"
        typeValue: "string"
        findValue: "snort"
        replaceValue: "TEST_SNORT_ID"
      - fieldSearchName: "extraData"
        typeValue: "string"
        findValue: "null"
        replaceValue: "DATA EXTRACTION"
      - fieldSearchName: "patternId"
        typeValue: "string"
        findValue: "T1110"
        replaceValue: "null"
  - actionType: "pass"
    listRequiredValues:
      - fieldSearchName: "impactStatus"
        typeValue: "string"
        findValue: "WithImpact"
      - fieldSearchName: "resolutionStatus"
        typeValue: "string"
        findValue: "TruePositive"
  - actionType: "reject" 
    listRequiredValues:
      - fieldSearchName: "namespace"
        typeValue: "string"
        findValue: "IP-API"
#  - actionType: "passany"
