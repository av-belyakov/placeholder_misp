2023/10/26 14:04:03 	---------------
	EVENTS:
ttp:
  1.
    extraData:
      pattern:
        "remoteSupport": false
        systemRequirements:
        "version": "1.2"
        defenseBypassed:
        extraData:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Linux"
          4. "macOS"
          5. "Containers"
        "patternId": "T1496"
        permissionsRequired:
          1. "User"
          2. "Administrator"
        "revoked": false
        tactics:
          1. "impact"
        "_createdAt": 1633310416346
        dataSources:
          1. "Process: Process Creation"
          2. "Command: Command Execution"
          3. "File: File Creation"
          4. "Network Traffic: Network Connection Creation"
          5. "Network Traffic: Network Traffic Flow"
          6. "Sensor Health: Host Status"
        "description": "Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. 

One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based(Citation: CloudSploit - Unused AWS Regions) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining. Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)

Additionally, some cryptocurrency mining malware kills off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)"
        "patternType": "attack-pattern"
        "_type": "Pattern"
        "detection": "Consider monitoring process resource usage to determine anomalous activity associated with malicious hijacking of computer resources such as CPU, memory, and graphics processing resources. Monitor for suspicious use of network resources associated with cryptocurrency mining software. Monitor for common cryptomining software process names and files on local systems that may indicate compromise and resource usage."
        "name": "Resource Hijacking"
        "_createdBy": "admin@thehive.local"
        "_id": "~4780280"
        "url": "https://attack.mitre.org/techniques/T1496"
    "occurDate": 1696458360000
    "patternId": "T1496"
    "tactic": "impact"
    "_createdAt": 1696513394035
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1493225472"
  2.
    "occurDate": 1696458360000
    "patternId": "T1499.004"
    "tactic": "impact"
    "_createdAt": 1696513394424
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1493229568"
    extraData:
      pattern:
        "_id": "~4730968"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        "_createdAt": 1633310440711
        "patternId": "T1499.004"
        "remoteSupport": false
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1499/004"
        defenseBypassed:
        "detection": "Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        extraData:
        "name": "Application or System Exploitation"
        permissionsRequired:
        "version": "1.1"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "description": "Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition."
        "patternType": "attack-pattern"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
        systemRequirements:
        tactics:
          1. "impact"
      patternParent:
        "capecId": "CAPEC-227"
        "description": "Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
"
        "patternId": "T1499"
        "patternType": "attack-pattern"
        "version": "1.1"
        "_id": "~45437080"
        extraData:
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        defenseBypassed:
        "_type": "Pattern"
        "capecUrl": "https://capec.mitre.org/data/definitions/227.html"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        "detection": "Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "name": "Endpoint Denial of Service"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        tactics:
          1. "impact"
        "_createdBy": "admin@thehive.local"
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1499"
        "_createdAt": 1633310387840
  3.
    "_createdAt": 1696513392957
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2108375216"
    extraData:
      pattern:
        platforms:
          1. "PRE"
        "remoteSupport": false
        "_createdBy": "admin@thehive.local"
        "name": "Malware"
        permissionsRequired:
        defenseBypassed:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle."
        systemRequirements:
        dataSources:
        "description": "Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries)."
        extraData:
        "patternId": "T1588.001"
        tactics:
          1. "resource-development"
        "_createdAt": 1633310495432
        "_id": "~5079288"
        "_type": "Pattern"
        "version": "1.0"
        "patternType": "attack-pattern"
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1588/001"
      patternParent:
        defenseBypassed:
        "patternType": "attack-pattern"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1588"
        "_createdAt": 1633310408517
        "_type": "Pattern"
        tactics:
          1. "resource-development"
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "revoked": false
        extraData:
        "remoteSupport": false
        "version": "1.0"
        dataSources:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "name": "Obtain Capabilities"
        "patternId": "T1588"
        permissionsRequired:
        platforms:
          1. "PRE"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
    "occurDate": 1696458360000
    "patternId": "T1588.001"
    "tactic": "resource-development"
  4.
    "_id": "~4462883056"
    extraData:
      pattern:
        "patternType": "attack-pattern"
        permissionsRequired:
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "exfiltration"
        dataSources:
          1. "Network Traffic: Network Connection Creation"
          2. "Network Traffic: Network Traffic Flow"
          3. "Network Traffic: Network Traffic Content"
          4. "File: File Access"
          5. "Command: Command Execution"
        "name": "Exfiltration Over Other Network Medium"
        "_createdAt": 1633310389333
        extraData:
        "patternId": "T1011"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1011"
        "_createdBy": "admin@thehive.local"
        "_id": "~4632824"
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel.

Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network"
        "detection": "Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces."
        "version": "1.1"
    "occurDate": 1696458360000
    "patternId": "T1011"
    "tactic": "exfiltration"
    "_createdAt": 1696513393340
    "_createdBy": "zsiem@rcm.lcl"
  5.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4462887152"
    extraData:
      pattern:
        dataSources:
          1. "Command: Command Execution"
          2. "Script: Script Execution"
          3. "Network Traffic: Network Connection Creation"
          4. "Network Traffic: Network Traffic Flow"
          5. "Network Traffic: Network Traffic Content"
          6. "File: File Access"
        "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)."
        "name": "Automated Exfiltration"
        permissionsRequired:
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        systemRequirements:
        "revoked": false
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        defenseBypassed:
        "detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious."
        extraData:
        "patternType": "attack-pattern"
        "_createdAt": 1633310372159
        "_id": "~4542712"
        "patternId": "T1020"
        "remoteSupport": false
        tactics:
          1. "exfiltration"
        "url": "https://attack.mitre.org/techniques/T1020"
        "version": "1.2"
    "occurDate": 1696458360000
    "patternId": "T1020"
    "tactic": "exfiltration"
    "_createdAt": 1696513393713
"source": "rcmkha"
event:
  "startDate": 1698329069148
  "rootId": "~1412231296"
  object:
    permissions:
    "createdBy": "zsiem@rcm.lcl"
    "owner": "zsiem@rcm.lcl"
    "endDate": 1698329056034
    "status": "Resolved"
    "createdAt": 1696513366164
    "impactStatus": "WithImpact"
    tags:
      1. "Sensor:id="310012""
      2. "Webhook: send="MISP""
      3. "tlp:amber"
      4. "NCIRCC:incident="Заражение ВПО""
      5. "svo:other"
      6. "Sensor:name="Правительство Хабаровского края (ул. Карла Маркса, д. 58)""
    stats:
    "_id": "~1412231296"
    "updatedBy": "zsiem@rcm.lcl"
    customFields:
      ncircc-class-attack:
        "string": "Заражение ВПО;incident"
        "order": 0
      verdict:
        "order": 10
        "string": "malware"
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      classification:
        "order": 9
        "string": "MacOS/Adload Proxy"
      first-time:
        "date": 1696458360000
        "order": 0
      last-time:
        "date": 1697762100000
        "order": 0
      misp-event-id:
      ncircc-bulletin-id:
    "caseId": 13925
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-I-20231005-12844`**

URL: **[https://utes.rcm/cgi/arm_eventdetail.php?eid=12844](https://utes.rcm/cgi/arm_eventdetail.php?eid=12844)**

Автор задачи: **`yav`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Функционирование ВПО`

Описание: `Функционирование ВПО (MacOS/Adload Proxy). ЦУ - 129.153.49.67, 129.153.53.180, 159.203.48.195, 159.203.49.5, 159.203.50.188, 174.138.115.38, 174.138.115.8, 192.18.144.233, 192.18.149.161, 192.18.150.139`

Отработало на СОА: 
- **`310012`** Правительство Хабаровского края (ул. Карла Маркса, д. 58), Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`05.10.2023 01:26:00`**
- Время окончания: **`20.10.2023 03:35:00`**
- **IP из домашней подсети**

1. **`91.233.247.209`**

- **IP или домены из внешней подсети**

1. **`129.153.49.67`**
2. **`129.153.53.180`**
3. **`159.203.48.195`**
4. **`159.203.49.5`**
5. **`159.203.50.188`**
6. **`174.138.115.38`**
7. **`174.138.115.8`**
8. **`192.18.144.233`**
9. **`192.18.149.161`**
10. **`192.18.150.139`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`2047629`**, Сообщение: ET TROJAN MacOS/Adload Proxy Node Beacon
2. РП: **`2047630`**, Сообщение: ET TROJAN MacOS/Adload Proxy Node Response

"
    "severity": 2
    "pap": 2
    "resolutionStatus": "TruePositive"
    "tlp": 2
    "startDate": 1696513366141
    "_type": "case"
    "title": "Функционирование ВПО (MacOS/Adload Proxy)."
    "flag": false
    "summary": "Результат мероприятий по реагированию на инцидент: **`Последствия КИ полностью устранены силами владельца ИР`**

Количество СВТ, вовлеченных в КИ: **`1`**

Выданные рекомендации:локализовать инфицированные объекты, провести антивирусную проверку, определить каналы внедрения ВПО и принять соответствующие меры по минимизации угроз, при наличии возможности переустановить операционную систему на зараженных компьютерах, установить средства антивирусной защиты с актуальными антивирусными базами, сменить аутентификационные данные для всех систем и пользователей на выявленных объектах 
"
    "id": "~1412231296"
    "updatedAt": 1698329069137
  "operation": "update"
  "objectType": "case"
  "objectId": "~1412231296"
  "base": true
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361687"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  details:
    customFields:
      ncircc-bulletin-id:
        "string": "MOWALL-23-10-7735"
observables:
  1.
    "sighted": false
    "tlp": 2
    extraData:
    "_createdBy": "tdp@rcm.lcl"
    "data": "FD67EA424CEC37BE6AE46BCB70415E883A051242F294EEB32DF71D11737FC17F"
    "ignoreSimilarity": false
    "ioc": false
    "message": ""
    "_createdAt": 1698306209181
    "startDate": 1698306209181
    "_type": "Observable"
    "dataType": "hash"
    reports:
      URLhaus_2_0:
        taxonomies:
          1.
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
            "level": "info"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "0 result"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "24/70"
      MISP_2_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "0 events"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
    tags:
      1. "misp:Payload delivery="sha256""
    "_id": "~2122518704"
  2.
    "ignoreSimilarity": false
    "_createdAt": 1698306089660
    "data": "gkdkfnbddpdpidbpnljcocpjeaafngdb"
    "dataType": "other"
    "message": "Плагин для браузера"
    reports:
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      MISP_2_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "0 events"
    "sighted": false
    "startDate": 1698306089660
    "_createdBy": "tdp@rcm.lcl"
    tags:
    "_type": "Observable"
    extraData:
    "ioc": false
    "tlp": 2
    "_id": "~4490678512"
  3.
    "data": "159.203.49.5"
    "ioc": true
    tags:
      1. "external"
    "_id": "~4462874864"
    extraData:
    reports:
      Robtex_Reverse_PDNS_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ReversePassiveDNS"
            "value": "1 entries"
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "2 detected_url(s)"
      MISP_2_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "value": "Канада "
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
      Robtex_IP_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "PassiveDNS"
            "value": "1 entries"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "value": "12 results"
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
    "_type": "Observable"
    "dataType": "ip"
    "_createdAt": 1696513389910
    "_createdBy": "zsiem@rcm.lcl"
    "sighted": false
    "startDate": 1696513389910
    "tlp": 2
  4.
    "startDate": 1696513389875
    "tlp": 2
    extraData:
    "ioc": true
    "sighted": false
    "dataType": "ip"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1412071488"
    "_createdAt": 1696513389875
    "data": "192.18.150.139"
    reports:
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "predicate": "Report"
            "value": "neutral"
            "level": "safe"
            "namespace": "Maltiverse"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "value": "1 result"
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      MISP_2_1:
        taxonomies:
          1.
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
            "level": "suspicious"
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "0 detected_url(s)"
            "level": "safe"
    tags:
      1. "external"
    "_type": "Observable"
  5.
    "tlp": 2
    "_createdAt": 1696513389968
    "data": "2047629,2047630"
    "sighted": false
    "startDate": 1696513389968
    extraData:
    tags:
      1. "snort"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1412075584"
    "_type": "Observable"
    reports:
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "zpmSig"
            "predicate": "Precision"
            "value": "unknown"
    "dataType": "snort_sid"
    "ioc": false
  6.
    "_createdAt": 1696513389742
    "_id": "~1412235392"
    "data": "174.138.115.38"
    "tlp": 2
    "ioc": true
    reports:
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "predicate": "Report"
            "value": "neutral"
            "level": "safe"
            "namespace": "Maltiverse"
      Robtex_IP_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ActiveDNS"
            "value": "1 entries"
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      MISP_2_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "value": "Канада "
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "0 result"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "0 detected_url(s)"
      ZPMSig_1_0:
        taxonomies:
          1.
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
            "level": "malicious"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "value": 0
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
    "sighted": false
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    "startDate": 1696513389742
    tags:
      1. "external"
  7.
    "tlp": 2
    "_createdAt": 1696513389892
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "ip"
    "ioc": true
    "sighted": false
    "startDate": 1696513389892
    "_id": "~1493213184"
    "_type": "Observable"
    extraData:
    reports:
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
      URLhaus_2_0:
        taxonomies:
          1.
            "value": "No results"
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "0 detected_url(s)"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
            "level": "info"
      MISP_2_1:
        taxonomies:
          1.
            "value": "1 event(s)"
            "level": "suspicious"
            "namespace": "MISP"
            "predicate": "Search"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "value": "0 result"
            "level": "info"
            "namespace": "urlscan.io"
            "predicate": "Search"
    "data": "129.153.49.67"
    tags:
      1. "external"
  8.
    "_createdBy": "zsiem@rcm.lcl"
    reports:
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
      URLhaus_2_0:
        taxonomies:
          1.
            "value": "No results"
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "1 result"
            "level": "suspicious"
            "namespace": "urlscan.io"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "value": "0 hits"
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
      MISP_2_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
    "startDate": 1696513389816
    "_id": "~1412067392"
    "_type": "Observable"
    "data": "192.18.144.233"
    extraData:
    "sighted": false
    "ioc": true
    tags:
      1. "external"
    "_createdAt": 1696513389816
    "dataType": "ip"
    "tlp": 2
  9.
    "startDate": 1696513389946
    "data": "192.18.149.161"
    extraData:
    "ioc": true
    "sighted": false
    "_createdBy": "zsiem@rcm.lcl"
    "tlp": 2
    "_createdAt": 1696513389946
    "_id": "~1493217280"
    reports:
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      MISP_2_1:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "1 event(s)"
            "level": "suspicious"
            "namespace": "MISP"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "0 detected_url(s)"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "predicate": "Report"
            "value": "neutral"
            "level": "safe"
            "namespace": "Maltiverse"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "0 result"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "predicate": "Records"
            "value": 0
            "level": "safe"
            "namespace": "AbuseIPDB"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "value": "0 hits"
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
    tags:
      1. "external"
    "_type": "Observable"
    "dataType": "ip"
  10.
    "startDate": 1696513389856
    reports:
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "1 detected_url(s)"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "predicate": "Country"
            "value": "Канада "
            "level": "info"
            "namespace": "GeoIP"
      Robtex_IP_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ActiveDNS"
            "value": "1 entries"
      URLhaus_2_0:
        taxonomies:
          1.
            "value": "No results"
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "value": "0 hits"
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
      MISP_2_1:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "1 event(s)"
            "level": "suspicious"
            "namespace": "MISP"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "1 result"
    "tlp": 2
    "dataType": "ip"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1412239488"
    "_type": "Observable"
    "ioc": true
    tags:
      1. "external"
    "_createdAt": 1696513389856
    extraData:
    "sighted": false
    "data": "174.138.115.8"
  11.
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "ioc": true
    tags:
      1. "external"
    "_createdAt": 1696513389927
    "_id": "~4462878960"
    "data": "159.203.50.188"
    "dataType": "ip"
    reports:
      Robtex_Reverse_PDNS_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ReversePassiveDNS"
            "value": "1 entries"
      URLhaus_2_0:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "No results"
            "level": "info"
            "namespace": "URLhaus"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "value": "3 results"
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
      ZPMSig_1_0:
        taxonomies:
          1.
            "value": "Found"
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "value": "0 hits"
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
      Robtex_IP_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "PassiveDNS"
            "value": "1 entries"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "value": "16 detected_url(s)"
            "level": "malicious"
            "namespace": "VT"
            "predicate": "GetReport"
      MISP_2_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "value": "suspicious"
            "level": "suspicious"
            "namespace": "Maltiverse"
            "predicate": "Report"
    "sighted": false
    "startDate": 1696513389927
    extraData:
    "tlp": 2
  12.
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "data": "129.153.53.180"
    reports:
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "0 result"
      ZPMSig_1_0:
        taxonomies:
          1.
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
            "level": "malicious"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Канада "
            "level": "info"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "1 detected_url(s)"
            "level": "suspicious"
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
            "level": "safe"
      MISP_2_1:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "1 event(s)"
            "level": "suspicious"
            "namespace": "MISP"
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
    "sighted": false
    "tlp": 2
    "_id": "~1740259528"
    "dataType": "ip"
    "ioc": true
    tags:
      1. "external"
    "_createdAt": 1696513389794
    extraData:
    "startDate": 1696513389794
  13.
    "_createdAt": 1696513389837
    "_createdBy": "zsiem@rcm.lcl"
    "startDate": 1696513389837
    "_id": "~4462870768"
    "_type": "Observable"
    tags:
      1. "external"
    "tlp": 2
    "dataType": "ip"
    extraData:
    "data": "159.203.48.195"
    "ioc": true
    reports:
      AbuseIPDB_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "AbuseIPDB"
            "predicate": "Records"
            "value": 0
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      MISP_2_1:
        taxonomies:
          1.
            "namespace": "MISP"
            "predicate": "Search"
            "value": "1 event(s)"
            "level": "suspicious"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "0 detected_url(s)"
      ZPMSig_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "ZPM_Sensor"
            "predicate": "IP"
            "value": "Found"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "neutral"
            "level": "safe"
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "predicate": "Country"
            "value": "Канада "
            "level": "info"
            "namespace": "GeoIP"
      URLhaus_2_0:
        taxonomies:
          1.
            "value": "No results"
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "predicate": "Search"
            "value": "2 results"
            "level": "suspicious"
            "namespace": "urlscan.io"
    "sighted": false
  14.
    "_id": "~1412063296"
    "data": "91.233.247.209"
    tags:
      1. "home"
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "tlp": 2
    "_type": "Observable"
    "dataType": "ip_home"
    reports:
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "predicate": "Country"
            "value": "Россия , ГосСОПКА"
            "level": "safe"
            "namespace": "GeoIP"
    "_createdAt": 1696513389772
    "ioc": false
    "sighted": false
    "startDate": 1696513389772


2023/10/26 14:05:13 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "operation": "update"
  details:
    customFields:
      "verdict": "malware"
      class-attack:
        "string": "Вирусное заражение"
        "order": 0
      "classification": "Win32.Fadok/Razy"
      first-time:
        "date": 1697162700000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
  object:
    "id": "~1417007232"
    "createdAt": 1697206490236
    "_type": "case"
    "createdBy": "zsiem@rcm.lcl"
    "flag": false
    customFields:
      classification:
        "order": 9
        "string": "Win32.Fadok/Razy"
      first-time:
        "date": 1697162700000
        "order": 0
      ncircc-class-attack:
        "string": "Заражение ВПО;incident"
        "order": 0
      verdict:
        "order": 10
        "string": "malware"
      class-attack:
        "string": "Вирусное заражение"
        "order": 0
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-I-20231013-12910`**

URL: **[https://utes.rcm/cgi/arm_eventdetail.php?eid=12910](https://utes.rcm/cgi/arm_eventdetail.php?eid=12910)**

Автор задачи: **`yav`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Функционирование ВПО`

Описание: `Функционирование ВПО (Win32.Fadok/Razy). ЦУ - wxanalytics.ru`

Отработало на СОА: 
- **`310040`** ФГБОУ ВО «Тихоокеанский государственный университет», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`13.10.2023 05:05:00`**
- Время окончания: **`-`**
- **IP из домашней подсети**

1. **`85.142.68.17`**
2. **`85.142.70.3`**
3. **`85.142.70.38`**

- **IP или домены из внешней подсети**

1. **`wxanalytics.ru`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`91003144`**, Сообщение: [NCCCI] DNS request for domain wxanalytics.ru - net Win32/Fadok

"
    "impactStatus": ""
    "tlp": 2
    "pap": 2
    "status": "Open"
    "summary": ""
    "owner": "zsiem@rcm.lcl"
    stats:
    "updatedBy": "zsiem@rcm.lcl"
    tags:
      1. "Sensor:id="310040""
      2. "Sensor:name="ФГБОУ ВО «Тихоокеанский государственный университет»""
      3. "tlp:amber"
      4. "NCIRCC:incident="Заражение ВПО""
      5. "svo:other"
    "startDate": 1697206490210
    "endDate": 0
    "severity": 2
    "_id": "~1417007232"
    "title": "Функционирование ВПО (Win32.Fadok/Razy)."
    "updatedAt": 1698329141260
    "caseId": 14116
    "resolutionStatus": ""
    permissions:
  "organisationId": "~4136"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361701"
  "organisation": "RCM_DFO"
  "objectType": "case"
  "objectId": "~1417007232"
  "base": true
  "startDate": 1698329141268
  "rootId": "~1417007232"
observables:
  1.
    reports:
    "sighted": false
    tags:
      1. "home"
    "_createdAt": 1698070250318
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "data": "85.142.70.38"
    "ioc": false
    "dataType": "ip_home"
    extraData:
    "startDate": 1698070250318
    "_id": "~1208291512"
    "tlp": 2
  2.
    extraData:
    "ioc": false
    reports:
    "_createdAt": 1697206501109
    "dataType": "ip_home"
    "startDate": 1697206501109
    "_type": "Observable"
    "tlp": 2
    "_id": "~1416892480"
    "data": "85.142.70.3"
    "sighted": false
    tags:
      1. "home"
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "_createdAt": 1697206501143
    tags:
      1. "Malware "
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "data": "wxanalytics.ru"
    "sighted": false
    "tlp": 2
    "dataType": "domain"
    "startDate": 1697206501143
    "_id": "~1417011328"
    extraData:
    "ioc": true
    reports:
  4.
    "_createdBy": "zsiem@rcm.lcl"
    reports:
    "tlp": 2
    "_type": "Observable"
    "dataType": "snort_sid"
    "ioc": false
    "_createdAt": 1697206501126
    tags:
      1. "snort"
    "sighted": false
    "startDate": 1697206501126
    "_id": "~1416896576"
    "data": "91003144"
    extraData:
  5.
    "_createdAt": 1697206501154
    "_createdBy": "zsiem@rcm.lcl"
    "data": "85.142.68.17"
    extraData:
    reports:
    "sighted": false
    tags:
      1. "home"
    "startDate": 1697206501154
    "tlp": 2
    "_id": "~2113253552"
    "_type": "Observable"
    "dataType": "ip_home"
    "ioc": false
ttp:
  1.
    "patternId": "T1496"
    "tactic": "impact"
    "_createdAt": 1697206506070
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1195032760"
    extraData:
      pattern:
        "_createdAt": 1633310416346
        "_type": "Pattern"
        extraData:
        "revoked": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1496"
        "_id": "~4780280"
        dataSources:
          1. "Process: Process Creation"
          2. "Command: Command Execution"
          3. "File: File Creation"
          4. "Network Traffic: Network Connection Creation"
          5. "Network Traffic: Network Traffic Flow"
          6. "Sensor Health: Host Status"
        defenseBypassed:
        "patternId": "T1496"
        "patternType": "attack-pattern"
        tactics:
          1. "impact"
        "_createdBy": "admin@thehive.local"
        "name": "Resource Hijacking"
        "version": "1.2"
        "description": "Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. 

One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based(Citation: CloudSploit - Unused AWS Regions) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining. Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)

Additionally, some cryptocurrency mining malware kills off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)"
        "detection": "Consider monitoring process resource usage to determine anomalous activity associated with malicious hijacking of computer resources such as CPU, memory, and graphics processing resources. Monitor for suspicious use of network resources associated with cryptocurrency mining software. Monitor for common cryptomining software process names and files on local systems that may indicate compromise and resource usage."
        permissionsRequired:
          1. "User"
          2. "Administrator"
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Linux"
          4. "macOS"
          5. "Containers"
        "remoteSupport": false
    "occurDate": 1697162700000
  2.
    "patternId": "T1499.004"
    "tactic": "impact"
    "_createdAt": 1697206506360
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1744527560"
    extraData:
      pattern:
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
        systemRequirements:
        "_createdAt": 1633310440711
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "impact"
        "version": "1.1"
        "detection": "Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        extraData:
        "patternId": "T1499.004"
        "patternType": "attack-pattern"
        "_id": "~4730968"
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition."
        "name": "Application or System Exploitation"
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1499/004"
      patternParent:
        "_createdAt": 1633310387840
        "capecId": "CAPEC-227"
        "capecUrl": "https://capec.mitre.org/data/definitions/227.html"
        "description": "Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
"
        extraData:
        "patternType": "attack-pattern"
        permissionsRequired:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1499"
        "_id": "~45437080"
        "detection": "Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "revoked": false
        "_createdBy": "admin@thehive.local"
        "name": "Endpoint Denial of Service"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        tactics:
          1. "impact"
        "_type": "Pattern"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        defenseBypassed:
        "patternId": "T1499"
        systemRequirements:
        "version": "1.1"
    "occurDate": 1697162700000
  3.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2113257648"
    extraData:
      pattern:
        "revoked": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1020"
        extraData:
        "remoteSupport": false
        dataSources:
          1. "Command: Command Execution"
          2. "Script: Script Execution"
          3. "Network Traffic: Network Connection Creation"
          4. "Network Traffic: Network Traffic Flow"
          5. "Network Traffic: Network Traffic Content"
          6. "File: File Access"
        "detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious."
        "patternId": "T1020"
        permissionsRequired:
        "_id": "~4542712"
        "_type": "Pattern"
        "name": "Automated Exfiltration"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "version": "1.2"
        defenseBypassed:
        "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)."
        "patternType": "attack-pattern"
        tactics:
          1. "exfiltration"
        "_createdAt": 1633310372159
        "_createdBy": "admin@thehive.local"
    "occurDate": 1697162700000
    "patternId": "T1020"
    "tactic": "exfiltration"
    "_createdAt": 1697206505753
  4.
    extraData:
      pattern:
        "patternId": "T1588.001"
        "_id": "~5079288"
        "_type": "Pattern"
        "description": "Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries)."
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle."
        extraData:
        systemRequirements:
        "version": "1.0"
        "_createdAt": 1633310495432
        dataSources:
        "patternType": "attack-pattern"
        "remoteSupport": false
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1588/001"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "name": "Malware"
        platforms:
          1. "PRE"
        tactics:
          1. "resource-development"
        permissionsRequired:
      patternParent:
        "_id": "~45645904"
        "patternId": "T1588"
        dataSources:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        "version": "1.0"
        "_type": "Pattern"
        extraData:
        "name": "Obtain Capabilities"
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "resource-development"
        "url": "https://attack.mitre.org/techniques/T1588"
        "_createdAt": 1633310408517
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        permissionsRequired:
        systemRequirements:
    "occurDate": 1697162700000
    "patternId": "T1588.001"
    "tactic": "resource-development"
    "_createdAt": 1697206505119
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4472357104"
  5.
    "_id": "~4472361200"
    extraData:
    "occurDate": 1697162700000
    "patternId": "T1011"
    "tactic": "exfiltration"
    "_createdAt": 1697206505462
    "_createdBy": "zsiem@rcm.lcl"


2023/10/26 14:08:46 	---------------
	EVENTS:
event:
  "objectId": "~1198661816"
  "base": true
  "startDate": 1698329355097
  "rootId": "~1198661816"
  object:
    "severity": 2
    "endDate": 0
    "impactStatus": ""
    "resolutionStatus": ""
    "id": "~1198661816"
    "_type": "case"
    "summary": ""
    stats:
    "createdAt": 1697549851414
    "updatedAt": 1698329355088
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-I-20231017-12919`**

URL: **[https://utes.rcm/cgi/arm_eventdetail.php?eid=12919](https://utes.rcm/cgi/arm_eventdetail.php?eid=12919)**

Автор задачи: **`yav`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Функционирование ВПО`

Описание: `Функционирование ВПО (Trojan.Win32.Antiemul.ao). ЦУ - 120266265.com, 269163390.com, 375780640.com, 418060515.com, 524677765.com, 566957640.com, 673574890.com, 715854765.com, 822472015.com, 864751890.com, 971369140.com`

Отработало на СОА: 
- **`310040`** ФГБОУ ВО «Тихоокеанский государственный университет», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`18.10.2023 01:58:00`**
- Время окончания: **`-`**
- **IP из домашней подсети**

1. **`85.142.70.3`**

- **IP или домены из внешней подсети**

1. **`120266265.com`**
2. **`269163390.com`**
3. **`375780640.com`**
4. **`418060515.com`**
5. **`524677765.com`**
6. **`566957640.com`**
7. **`673574890.com`**
8. **`715854765.com`**
9. **`822472015.com`**
10. **`864751890.com`**
11. **`971369140.com`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**


"
    "startDate": 1697549851396
    tags:
      1. "Sensor:id="310040""
      2. "Sensor:name="ФГБОУ ВО «Тихоокеанский государственный университет»""
      3. "tlp:amber"
      4. "NCIRCC:incident="Заражение ВПО""
      5. "svo:other"
    "flag": false
    "pap": 2
    "status": "Open"
    "owner": "zsiem@rcm.lcl"
    customFields:
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      classification:
        "order": 9
        "string": "Trojan.Win32.Antiemul.ao"
      first-time:
        "date": 1697583480000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
      verdict:
        "order": 10
        "string": "malware"
    permissions:
    "_id": "~1198661816"
    "createdBy": "zsiem@rcm.lcl"
    "updatedBy": "zsiem@rcm.lcl"
    "tlp": 2
    "caseId": 14205
    "title": "Функционирование ВПО (Trojan.Win32.Antiemul.ao)."
  "operation": "update"
  "objectType": "case"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  details:
    customFields:
      first-time:
        "date": 1697583480000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
      "verdict": "malware"
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      "classification": "Trojan.Win32.Antiemul.ao"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361725"
observables:
  1.
    extraData:
    "startDate": 1697549875390
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "domain"
    reports:
    "_id": "~1499684864"
    "_type": "Observable"
    "tlp": 2
    "sighted": false
    tags:
      1. "Malware "
    "_createdAt": 1697549875390
    "data": "971369140.com"
    "ioc": true
  2.
    extraData:
    reports:
    "sighted": false
    "_id": "~1418784896"
    "dataType": "domain"
    "tlp": 2
    "ioc": true
    "startDate": 1697549875373
    "_type": "Observable"
    tags:
      1. "Malware "
    "data": "822472015.com"
    "_createdAt": 1697549875373
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "_createdAt": 1697549875290
    "_type": "Observable"
    "data": "566957640.com"
    "dataType": "domain"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1418608704"
    "ioc": true
    reports:
    "sighted": false
    tags:
      1. "Malware "
    "tlp": 2
    extraData:
    "startDate": 1697549875290
  4.
    "ioc": false
    "sighted": false
    tags:
      1. "home"
    "_createdAt": 1697549875193
    "data": "85.142.70.3"
    "tlp": 2
    reports:
    "startDate": 1697549875193
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4475937008"
    "_type": "Observable"
    "dataType": "ip_home"
    extraData:
  5.
    "data": "715854765.com"
    reports:
    tags:
      1. "Malware "
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "domain"
    extraData:
    "ioc": true
    "sighted": false
    "tlp": 2
    "_createdAt": 1697549875236
    "_id": "~1746182344"
    "startDate": 1697549875236
  6.
    "_createdAt": 1697549875357
    "_createdBy": "zsiem@rcm.lcl"
    "data": "673574890.com"
    reports:
    tags:
      1. "Malware "
    "startDate": 1697549875357
    "tlp": 2
    "_id": "~2114932912"
    "_type": "Observable"
    "dataType": "domain"
    extraData:
    "ioc": true
    "sighted": false
  7.
    extraData:
    "_createdAt": 1697549875218
    "_createdBy": "zsiem@rcm.lcl"
    "startDate": 1697549875218
    "sighted": false
    tags:
      1. "Malware "
    "_id": "~1418604608"
    "data": "524677765.com"
    "dataType": "domain"
    "tlp": 2
    "_type": "Observable"
    "ioc": true
    reports:
  8.
    "dataType": "domain"
    "sighted": false
    "startDate": 1697549875254
    "tlp": 2
    "_createdAt": 1697549875254
    "data": "269163390.com"
    extraData:
    reports:
    tags:
      1. "Malware "
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": true
    "_type": "Observable"
    "_id": "~1418776704"
  9.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1418612800"
    "dataType": "domain"
    "_type": "Observable"
    extraData:
    "ioc": true
    reports:
    "startDate": 1697549875341
    "tlp": 2
    "_createdAt": 1697549875341
    "data": "120266265.com"
    "sighted": false
    tags:
      1. "Malware "
  10.
    "_createdAt": 1697549875308
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "tlp": 2
    "dataType": "domain"
    tags:
      1. "Malware "
    "data": "375780640.com"
    reports:
    "startDate": 1697549875308
    "_id": "~4475941104"
    "_type": "Observable"
    "ioc": true
    "sighted": false
  11.
    "_id": "~1418780800"
    "_type": "Observable"
    reports:
    "sighted": false
    "startDate": 1697549875272
    extraData:
    "tlp": 2
    "_createdAt": 1697549875272
    "data": "418060515.com"
    "ioc": true
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "domain"
    tags:
      1. "Malware "
  12.
    "_type": "Observable"
    tags:
      1. "Malware "
    "tlp": 2
    "_id": "~4475945200"
    "data": "864751890.com"
    "ioc": true
    reports:
    "_createdAt": 1697549875324
    "dataType": "domain"
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "sighted": false
    "startDate": 1697549875324
ttp:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~927137952"
    extraData:
      pattern:
        "_createdAt": 1633310495432
        "_createdBy": "admin@thehive.local"
        "_id": "~5079288"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle."
        permissionsRequired:
        platforms:
          1. "PRE"
        "description": "Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries)."
        extraData:
        "patternId": "T1588.001"
        tactics:
          1. "resource-development"
        dataSources:
        defenseBypassed:
        "patternType": "attack-pattern"
        "revoked": false
        systemRequirements:
        "version": "1.0"
        "_type": "Pattern"
        "name": "Malware"
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588/001"
      patternParent:
        "patternId": "T1588"
        platforms:
          1. "PRE"
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        permissionsRequired:
        "_createdAt": 1633310408517
        "_id": "~45645904"
        dataSources:
        extraData:
        "url": "https://attack.mitre.org/techniques/T1588"
        "version": "1.0"
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        "name": "Obtain Capabilities"
        "patternType": "attack-pattern"
    "occurDate": 1697547000000
    "patternId": "T1588.001"
    "tactic": "resource-development"
    "_createdAt": 1697549878437
  2.
    "tactic": "exfiltration"
    "_createdAt": 1697549878848
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~927142048"
    extraData:
      pattern:
        "patternId": "T1011"
        "remoteSupport": false
        tactics:
          1. "exfiltration"
        "_createdAt": 1633310389333
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "detection": "Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces."
        "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel.

Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network"
        extraData:
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
        "version": "1.1"
        systemRequirements:
        "_id": "~4632824"
        "patternType": "attack-pattern"
        permissionsRequired:
        "revoked": false
        dataSources:
          1. "Network Traffic: Network Connection Creation"
          2. "Network Traffic: Network Traffic Flow"
          3. "Network Traffic: Network Traffic Content"
          4. "File: File Access"
          5. "Command: Command Execution"
        defenseBypassed:
        "name": "Exfiltration Over Other Network Medium"
        "url": "https://attack.mitre.org/techniques/T1011"
    "occurDate": 1697547000000
    "patternId": "T1011"
  3.
    "tactic": "exfiltration"
    "_createdAt": 1697549879239
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1198670008"
    extraData:
      pattern:
        "name": "Automated Exfiltration"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "revoked": false
        "_createdAt": 1633310372159
        "_id": "~4542712"
        dataSources:
          1. "Command: Command Execution"
          2. "Script: Script Execution"
          3. "Network Traffic: Network Connection Creation"
          4. "Network Traffic: Network Traffic Flow"
          5. "Network Traffic: Network Traffic Content"
          6. "File: File Access"
        defenseBypassed:
        extraData:
        "url": "https://attack.mitre.org/techniques/T1020"
        "version": "1.2"
        "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)."
        "patternId": "T1020"
        "patternType": "attack-pattern"
        permissionsRequired:
        "remoteSupport": false
        systemRequirements:
        tactics:
          1. "exfiltration"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious."
    "occurDate": 1697547000000
    "patternId": "T1020"
  4.
    extraData:
      pattern:
        "detection": "Consider monitoring process resource usage to determine anomalous activity associated with malicious hijacking of computer resources such as CPU, memory, and graphics processing resources. Monitor for suspicious use of network resources associated with cryptocurrency mining software. Monitor for common cryptomining software process names and files on local systems that may indicate compromise and resource usage."
        extraData:
        "patternType": "attack-pattern"
        "remoteSupport": false
        "revoked": false
        "_createdAt": 1633310416346
        "_id": "~4780280"
        "_type": "Pattern"
        "description": "Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. 

One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based(Citation: CloudSploit - Unused AWS Regions) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining. Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)

Additionally, some cryptocurrency mining malware kills off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)"
        "name": "Resource Hijacking"
        "patternId": "T1496"
        systemRequirements:
        defenseBypassed:
        permissionsRequired:
          1. "User"
          2. "Administrator"
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Linux"
          4. "macOS"
          5. "Containers"
        tactics:
          1. "impact"
        "url": "https://attack.mitre.org/techniques/T1496"
        "version": "1.2"
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "Process: Process Creation"
          2. "Command: Command Execution"
          3. "File: File Creation"
          4. "Network Traffic: Network Connection Creation"
          5. "Network Traffic: Network Traffic Flow"
          6. "Sensor Health: Host Status"
    "occurDate": 1697547000000
    "patternId": "T1496"
    "tactic": "impact"
    "_createdAt": 1697549879608
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1198674104"
  5.
    "_id": "~2114941104"
    extraData:
      pattern:
        "_createdAt": 1633310440711
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        extraData:
        "patternId": "T1499.004"
        "patternType": "attack-pattern"
        "version": "1.1"
        "description": "Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition."
        systemRequirements:
        "_createdBy": "admin@thehive.local"
        "detection": "Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "name": "Application or System Exploitation"
        permissionsRequired:
        "_id": "~4730968"
        "_type": "Pattern"
        defenseBypassed:
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "impact"
        "url": "https://attack.mitre.org/techniques/T1499/004"
      patternParent:
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        permissionsRequired:
        "remoteSupport": false
        systemRequirements:
        tactics:
          1. "impact"
        "version": "1.1"
        "_createdBy": "admin@thehive.local"
        "_id": "~45437080"
        "description": "Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
"
        "detection": "Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        extraData:
        "patternType": "attack-pattern"
        "capecId": "CAPEC-227"
        defenseBypassed:
        "name": "Endpoint Denial of Service"
        "patternId": "T1499"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "url": "https://attack.mitre.org/techniques/T1499"
        "_createdAt": 1633310387840
        "_type": "Pattern"
        "capecUrl": "https://capec.mitre.org/data/definitions/227.html"
        "revoked": false
    "occurDate": 1697547000000
    "patternId": "T1499.004"
    "tactic": "impact"
    "_createdAt": 1697549879971
    "_createdBy": "zsiem@rcm.lcl"
"source": "rcmkha"


2023/10/26 14:09:59 	---------------
	EVENTS:
"source": "rcmkha"
event:
  details:
    customFields:
      "classification": "Purplefox"
      first-time:
        "order": 0
        "date": 1698244560000
      last-time:
        "date": 1698298920000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
      "verdict": "malware"
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
  "objectType": "case"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361737"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  object:
    "flag": false
    stats:
    "id": "~4489789680"
    "_type": "case"
    "resolutionStatus": ""
    "updatedBy": "zsiem@rcm.lcl"
    "impactStatus": ""
    "severity": 2
    "endDate": 0
    "pap": 2
    permissions:
    "createdAt": 1698275138764
    "owner": "zsiem@rcm.lcl"
    "title": "Функционирование ВПО (Purplefox)."
    "status": "Open"
    customFields:
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      classification:
        "order": 9
        "string": "Purplefox"
      first-time:
        "date": 1698244560000
        "order": 0
      last-time:
        "date": 1698298920000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
      verdict:
        "order": 10
        "string": "malware"
    "startDate": 1698275138740
    tags:
      1. "Sensor:name="Администрация г. Южно-Сахалинска""
      2. "tlp:amber"
      3. "NCIRCC:incident="Заражение ВПО""
      4. "svo:other"
      5. "Sensor:id="310042""
    "createdBy": "zsiem@rcm.lcl"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-I-20231025-12937`**

URL: **[https://utes.rcm/cgi/arm_eventdetail.php?eid=12937](https://utes.rcm/cgi/arm_eventdetail.php?eid=12937)**

Автор задачи: **`yav`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Функционирование ВПО`

Описание: `Функционирование ВПО (Purplefox). ЦУ - 10.via0.com, via0.com`

Отработало на СОА: 
- **`310042`** Администрация г. Южно-Сахалинска, Установлен: Сахалинская область, Южно-Сахалинск



**Полное описание события IDS:**

- Время начала: **`25.10.2023 17:36:00`**
- Время окончания: **`26.10.2023 08:42:00`**
- **IP из домашней подсети**

1. **`213.5.73.4`**

- **IP или домены из внешней подсети**

1. **`10.via0.com`**
2. **`via0.com`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**


"
    "caseId": 14424
    "tlp": 2
    "summary": ""
    "_id": "~4489789680"
    "updatedAt": 1698329427928
  "operation": "update"
  "objectId": "~4489789680"
  "base": true
  "startDate": 1698329427937
  "rootId": "~4489789680"
observables:
  1.
    "sighted": false
    tags:
      1. "Malware "
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1212838072"
    "ioc": true
    "data": "via0.com"
    extraData:
    reports:
      SpamhausDBL_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "SpamhausDBL"
            "predicate": "classification"
            "value": "Clean"
          2.
            "level": "info"
            "namespace": "SpamhausDBL"
            "predicate": "return_code"
            "value": "NXDOMAIN"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "89 detected_url(s)"
      Crt_sh_Transparency_Logs_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "crt.sh"
            "predicate": "Certificates"
            "value": "627"
      MISP_2_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "0 events"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "Maltiverse"
            "predicate": "Report"
            "value": "-"
      Urlscan_io_Scan_0_1_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "urlscan.io"
            "predicate": "Scan"
            "value": "Overall Score:100"
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "145 results"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      Robtex_Forward_PDNS_Query_1_0:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ForwardPassiveDNS"
            "value": "23 entries"
      URLhaus_2_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
    "startDate": 1698275156728
    "tlp": 2
    "_createdAt": 1698275156728
    "_type": "Observable"
    "dataType": "domain"
  2.
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": false
    "sighted": false
    "_type": "Observable"
    extraData:
    tags:
      1. "home"
    "tlp": 2
    "_createdAt": 1698275156714
    "data": "213.5.73.4"
    "startDate": 1698275156714
    "_id": "~1752875208"
    "dataType": "ip_home"
    reports:
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Россия , ГосСОПКА"
ttp:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~933634208"
    extraData:
      pattern:
        "patternType": "attack-pattern"
        permissionsRequired:
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
        "revoked": false
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "detection": "Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces."
        "name": "Exfiltration Over Other Network Medium"
        tactics:
          1. "exfiltration"
        "_createdAt": 1633310389333
        "_type": "Pattern"
        dataSources:
          1. "Network Traffic: Network Connection Creation"
          2. "Network Traffic: Network Traffic Flow"
          3. "Network Traffic: Network Traffic Content"
          4. "File: File Access"
          5. "Command: Command Execution"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1011"
        "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel.

Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network"
        extraData:
        "patternId": "T1011"
        "remoteSupport": false
        "_id": "~4632824"
        "version": "1.1"
    "occurDate": 1698191760000
    "patternId": "T1011"
    "tactic": "exfiltration"
    "_createdAt": 1698275160654
  2.
    extraData:
      pattern:
        "patternId": "T1588.001"
        permissionsRequired:
        "_createdAt": 1633310495432
        defenseBypassed:
        extraData:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588/001"
        "_id": "~5079288"
        dataSources:
        "description": "Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries)."
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle."
        "revoked": false
        "version": "1.0"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "name": "Malware"
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        systemRequirements:
        tactics:
          1. "resource-development"
      patternParent:
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        extraData:
        permissionsRequired:
        "_createdAt": 1633310408517
        dataSources:
        "name": "Obtain Capabilities"
        tactics:
          1. "resource-development"
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternId": "T1588"
        platforms:
          1. "PRE"
        "version": "1.0"
        "patternType": "attack-pattern"
        "url": "https://attack.mitre.org/techniques/T1588"
    "occurDate": 1698191760000
    "patternId": "T1588.001"
    "tactic": "resource-development"
    "_createdAt": 1698275160305
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1212842168"
  3.
    extraData:
      pattern:
        "version": "1.1"
        extraData:
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1499/004"
        systemRequirements:
        "_type": "Pattern"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
        "name": "Application or System Exploitation"
        "patternId": "T1499.004"
        "revoked": false
        "_createdBy": "admin@thehive.local"
        "_id": "~4730968"
        "detection": "Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "patternType": "attack-pattern"
        "remoteSupport": false
        tactics:
          1. "impact"
        "_createdAt": 1633310440711
        defenseBypassed:
        "description": "Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition."
      patternParent:
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1499"
        "_createdAt": 1633310387840
        "capecId": "CAPEC-227"
        "capecUrl": "https://capec.mitre.org/data/definitions/227.html"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        "description": "Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "_createdBy": "admin@thehive.local"
        "_id": "~45437080"
        "_type": "Pattern"
        defenseBypassed:
        "patternType": "attack-pattern"
        tactics:
          1. "impact"
        "detection": "Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "patternId": "T1499"
        extraData:
        "name": "Endpoint Denial of Service"
        permissionsRequired:
        "remoteSupport": false
        systemRequirements:
        "version": "1.1"
    "occurDate": 1698191760000
    "patternId": "T1499.004"
    "tactic": "impact"
    "_createdAt": 1698275161590
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1425428544"
  4.
    "_id": "~1425735808"
    extraData:
      pattern:
        "url": "https://attack.mitre.org/techniques/T1496"
        "remoteSupport": false
        systemRequirements:
        "_type": "Pattern"
        extraData:
        "name": "Resource Hijacking"
        "patternId": "T1496"
        "patternType": "attack-pattern"
        "revoked": false
        "_createdAt": 1633310416346
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "description": "Adversaries may leverage the resources of co-opted systems in order to solve resource intensive problems which may impact system and/or hosted service availability. 

One common purpose for Resource Hijacking is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based(Citation: CloudSploit - Unused AWS Regions) systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for Resource Hijacking and cryptocurrency mining. Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)

Additionally, some cryptocurrency mining malware kills off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)"
        "detection": "Consider monitoring process resource usage to determine anomalous activity associated with malicious hijacking of computer resources such as CPU, memory, and graphics processing resources. Monitor for suspicious use of network resources associated with cryptocurrency mining software. Monitor for common cryptomining software process names and files on local systems that may indicate compromise and resource usage."
        permissionsRequired:
          1. "User"
          2. "Administrator"
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Linux"
          4. "macOS"
          5. "Containers"
        tactics:
          1. "impact"
        "_id": "~4780280"
        dataSources:
          1. "Process: Process Creation"
          2. "Command: Command Execution"
          3. "File: File Creation"
          4. "Network Traffic: Network Connection Creation"
          5. "Network Traffic: Network Traffic Flow"
          6. "Sensor Health: Host Status"
        "version": "1.2"
    "occurDate": 1698191760000
    "patternId": "T1496"
    "tactic": "impact"
    "_createdAt": 1698275161286
    "_createdBy": "zsiem@rcm.lcl"
  5.
    "occurDate": 1698191760000
    "patternId": "T1020"
    "tactic": "exfiltration"
    "_createdAt": 1698275160972
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2122105008"
    extraData:
      pattern:
        "_createdAt": 1633310372159
        "_createdBy": "admin@thehive.local"
        extraData:
        "_id": "~4542712"
        "_type": "Pattern"
        "patternType": "attack-pattern"
        systemRequirements:
        "remoteSupport": false
        dataSources:
          1. "Command: Command Execution"
          2. "Script: Script Execution"
          3. "Network Traffic: Network Connection Creation"
          4. "Network Traffic: Network Traffic Flow"
          5. "Network Traffic: Network Traffic Content"
          6. "File: File Access"
        "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)."
        "name": "Automated Exfiltration"
        "patternId": "T1020"
        permissionsRequired:
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        defenseBypassed:
        "detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious."
        "revoked": false
        tactics:
          1. "exfiltration"
        "url": "https://attack.mitre.org/techniques/T1020"
        "version": "1.2"


2023/10/26 14:10:04 	---------------
	EVENTS:
ttp:
  1.
    "_createdAt": 1698275160654
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~933634208"
    extraData:
      pattern:
        "_id": "~4632824"
        "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel.

Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network"
        "patternId": "T1011"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1011"
        defenseBypassed:
        extraData:
        "name": "Exfiltration Over Other Network Medium"
        "revoked": false
        tactics:
          1. "exfiltration"
        "_type": "Pattern"
        dataSources:
          1. "Network Traffic: Network Connection Creation"
          2. "Network Traffic: Network Traffic Flow"
          3. "Network Traffic: Network Traffic Content"
          4. "File: File Access"
          5. "Command: Command Execution"
        "detection": "Monitor for processes utilizing the network that do not normally have network communication or have never been seen before. Processes that normally require user-driven events to access the network (for example, a web browser opening with a mouse click or key press) but access the network without such may be malicious.

Monitor for and investigate changes to host adapter settings, such as addition and/or replication of communication interfaces."
        systemRequirements:
        "_createdAt": 1633310389333
        "_createdBy": "admin@thehive.local"
        "patternType": "attack-pattern"
        permissionsRequired:
        "version": "1.1"
    "occurDate": 1698191760000
    "patternId": "T1011"
    "tactic": "exfiltration"
  2.
    "_id": "~1212842168"
    extraData:
      pattern:
        "_createdAt": 1633310495432
        platforms:
          1. "PRE"
        "remoteSupport": false
        "revoked": false
        "version": "1.0"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        dataSources:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle."
        "name": "Malware"
        "url": "https://attack.mitre.org/techniques/T1588/001"
        "_id": "~5079288"
        extraData:
        "patternId": "T1588.001"
        tactics:
          1. "resource-development"
        defenseBypassed:
        "description": "Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries)."
        "patternType": "attack-pattern"
        permissionsRequired:
        systemRequirements:
      patternParent:
        "url": "https://attack.mitre.org/techniques/T1588"
        dataSources:
        extraData:
        "name": "Obtain Capabilities"
        "remoteSupport": false
        systemRequirements:
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "patternId": "T1588"
        "patternType": "attack-pattern"
        "revoked": false
        "_createdAt": 1633310408517
        "_id": "~45645904"
        "_type": "Pattern"
        platforms:
          1. "PRE"
        defenseBypassed:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        permissionsRequired:
        "version": "1.0"
    "occurDate": 1698191760000
    "patternId": "T1588.001"
    "tactic": "resource-development"
    "_createdAt": 1698275160305
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "tactic": "impact"
    "_createdAt": 1698275161590
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1425428544"
    extraData:
      pattern:
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        "detection": "Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack. Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        extraData:
        systemRequirements:
        tactics:
          1. "impact"
        "version": "1.1"
        "name": "Application or System Exploitation"
        "patternType": "attack-pattern"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1499/004"
        "_createdAt": 1633310440711
        "_createdBy": "admin@thehive.local"
        "_id": "~4730968"
        defenseBypassed:
        permissionsRequired:
        "_type": "Pattern"
        "description": "Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent DoS condition."
        "patternId": "T1499.004"
        "remoteSupport": false
      patternParent:
        "capecId": "CAPEC-227"
        "detection": "Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

Externally monitor the availability of services that may be targeted by an Endpoint DoS."
        "patternId": "T1499"
        "remoteSupport": false
        systemRequirements:
        "_id": "~45437080"
        "_type": "Pattern"
        "url": "https://attack.mitre.org/techniques/T1499"
        "name": "Endpoint Denial of Service"
        permissionsRequired:
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "revoked": false
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "Sensor Health: Host Status"
          2. "Application Log: Application Log Content"
          3. "Network Traffic: Network Traffic Content"
          4. "Network Traffic: Network Traffic Flow"
        defenseBypassed:
        "description": "Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

In cases where traffic manipulation is used, there may be points in the the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
"
        extraData:
        "patternType": "attack-pattern"
        tactics:
          1. "impact"
        "version": "1.1"
        "_createdAt": 1633310387840
        "capecUrl": "https://capec.mitre.org/data/definitions/227.html"
    "occurDate": 1698191760000
    "patternId": "T1499.004"
  4.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1425735808"
    extraData:
    "occurDate": 1698191760000
    "patternId": "T1496"
    "tactic": "impact"
    "_createdAt": 1698275161286
  5.
    "_createdAt": 1698275160972
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2122105008"
    extraData:
      pattern:
        "detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious."
        "name": "Automated Exfiltration"
        "patternId": "T1020"
        tactics:
          1. "exfiltration"
        "remoteSupport": false
        systemRequirements:
        dataSources:
          1. "Command: Command Execution"
          2. "Script: Script Execution"
          3. "Network Traffic: Network Connection Creation"
          4. "Network Traffic: Network Traffic Flow"
          5. "Network Traffic: Network Traffic Content"
          6. "File: File Access"
        "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. 

When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)."
        extraData:
        permissionsRequired:
        "revoked": false
        "_createdBy": "admin@thehive.local"
        "_id": "~4542712"
        "patternType": "attack-pattern"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "version": "1.2"
        "_createdAt": 1633310372159
        "_type": "Pattern"
        defenseBypassed:
        "url": "https://attack.mitre.org/techniques/T1020"
    "occurDate": 1698191760000
    "patternId": "T1020"
    "tactic": "exfiltration"
"source": "rcmkha"
event:
  object:
    "resolutionStatus": "Indeterminate"
    tags:
      1. "Sensor:name="Администрация г. Южно-Сахалинска""
      2. "tlp:amber"
      3. "NCIRCC:incident="Заражение ВПО""
      4. "svo:other"
      5. "Sensor:id="310042""
    "flag": false
    "title": "Функционирование ВПО (Purplefox)."
    "_type": "case"
    "tlp": 2
    "updatedBy": "zsiem@rcm.lcl"
    stats:
    "id": "~4489789680"
    "startDate": 1698275138740
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-I-20231025-12937`**

URL: **[https://utes.rcm/cgi/arm_eventdetail.php?eid=12937](https://utes.rcm/cgi/arm_eventdetail.php?eid=12937)**

Автор задачи: **`yav`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Функционирование ВПО`

Описание: `Функционирование ВПО (Purplefox). ЦУ - 10.via0.com, via0.com`

Отработало на СОА: 
- **`310042`** Администрация г. Южно-Сахалинска, Установлен: Сахалинская область, Южно-Сахалинск



**Полное описание события IDS:**

- Время начала: **`25.10.2023 17:36:00`**
- Время окончания: **`26.10.2023 08:42:00`**
- **IP из домашней подсети**

1. **`213.5.73.4`**

- **IP или домены из внешней подсети**

1. **`10.via0.com`**
2. **`via0.com`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**


"
    "caseId": 14424
    "endDate": 1698329432220
    "pap": 2
    "_id": "~4489789680"
    "updatedAt": 1698329432272
    "status": "Resolved"
    "owner": "zsiem@rcm.lcl"
    "createdBy": "zsiem@rcm.lcl"
    "createdAt": 1698275138764
    "severity": 2
    "impactStatus": "NoImpact"
    "summary": "Результат мероприятий по реагированию на инцидент: **`КИ не потвердился ответственными лицами контролируемого объекта`**

Количество СВТ, вовлеченных в КИ: **`1`**

Выданные рекомендации:локализовать инфицированные объекты, провести антивирусную проверку, определить каналы внедрения ВПО и принять соответствующие меры по минимизации угроз, при наличии возможности переустановить операционную систему на зараженных компьютерах, установить средства антивирусной защиты с актуальными антивирусными базами, сменить аутентификационные данные для всех систем и пользователей на выявленных объектах 
"
    customFields:
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      classification:
        "order": 9
        "string": "Purplefox"
      first-time:
        "date": 1698244560000
        "order": 0
      last-time:
        "date": 1698298920000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
    permissions:
  "operation": "update"
  details:
    "resolutionStatus": "Indeterminate"
    "summary": "Результат мероприятий по реагированию на инцидент: **`КИ не потвердился ответственными лицами контролируемого объекта`**

Количество СВТ, вовлеченных в КИ: **`1`**

Выданные рекомендации:локализовать инфицированные объекты, провести антивирусную проверку, определить каналы внедрения ВПО и принять соответствующие меры по минимизации угроз, при наличии возможности переустановить операционную систему на зараженных компьютерах, установить средства антивирусной защиты с актуальными антивирусными базами, сменить аутентификационные данные для всех систем и пользователей на выявленных объектах 
"
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329432220
    customFields:
      ncircc-class-attack:
        "order": 0
        "string": "Заражение ВПО;incident"
      class-attack:
        "order": 0
        "string": "Вирусное заражение"
      "classification": "Purplefox"
      first-time:
        "date": 1698244560000
        "order": 0
      last-time:
        "date": 1698298920000
        "order": 0
  "base": true
  "rootId": "~4489789680"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361744"
  "objectType": "case"
  "objectId": "~4489789680"
  "startDate": 1698329432282
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
observables:
  1.
    "data": "10.via0.com"
    "sighted": false
    "_createdAt": 1698329428455
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    tags:
      1. "Malware "
    "tlp": 2
    "_id": "~4493082864"
    "_type": "Observable"
    "startDate": 1698329428455
    "dataType": "domain"
    "ioc": true
    reports:
  2.
    extraData:
    "_type": "Observable"
    "ioc": true
    tags:
      1. "Malware "
    "startDate": 1698275156728
    "tlp": 2
    "_createdAt": 1698275156728
    "_id": "~1212838072"
    "dataType": "domain"
    "sighted": false
    "_createdBy": "zsiem@rcm.lcl"
    "data": "via0.com"
    reports:
      Urlscan_io_Search_0_1_1:
        taxonomies:
          1.
            "level": "suspicious"
            "namespace": "urlscan.io"
            "predicate": "Search"
            "value": "145 results"
      MISP_2_1:
        taxonomies:
          1.
            "level": "info"
            "namespace": "MISP"
            "predicate": "Search"
            "value": "0 events"
      Maltiverse_Report_1_0:
        taxonomies:
          1.
            "predicate": "Report"
            "value": "-"
            "level": "safe"
            "namespace": "Maltiverse"
      Robtex_Forward_PDNS_Query_1_0:
        taxonomies:
          1.
            "value": "23 entries"
            "level": "suspicious"
            "namespace": "Robtex"
            "predicate": "ForwardPassiveDNS"
      SpamhausDBL_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "SpamhausDBL"
            "predicate": "classification"
            "value": "Clean"
          2.
            "predicate": "return_code"
            "value": "NXDOMAIN"
            "level": "info"
            "namespace": "SpamhausDBL"
      URLhaus_2_0:
        taxonomies:
          1.
            "namespace": "URLhaus"
            "predicate": "Search"
            "value": "No results"
            "level": "info"
      Urlscan_io_Scan_0_1_0:
        taxonomies:
          1.
            "predicate": "Scan"
            "value": "Overall Score:100"
            "level": "malicious"
            "namespace": "urlscan.io"
      Crt_sh_Transparency_Logs_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "crt.sh"
            "predicate": "Certificates"
            "value": "627"
      CyberCrime-Tracker_1_0:
        taxonomies:
          1.
            "level": "info"
            "namespace": "CCT"
            "predicate": "C2 Search"
            "value": "0 hits"
      VirusTotal_GetReport_3_0:
        taxonomies:
          1.
            "level": "malicious"
            "namespace": "VT"
            "predicate": "GetReport"
            "value": "89 detected_url(s)"
  3.
    "ioc": false
    reports:
      NCIRCC_GeoIP_1_0:
        taxonomies:
          1.
            "level": "safe"
            "namespace": "GeoIP"
            "predicate": "Country"
            "value": "Россия , ГосСОПКА"
    "_type": "Observable"
    "dataType": "ip_home"
    "tlp": 2
    "_createdAt": 1698275156714
    "_id": "~1752875208"
    extraData:
    "sighted": false
    tags:
      1. "home"
    "_createdBy": "zsiem@rcm.lcl"
    "data": "213.5.73.4"
    "startDate": 1698275156714


2023/10/26 14:11:44 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "objectType": "case"
  "objectId": "~1754337480"
  "base": true
  "rootId": "~1754337480"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361785"
  object:
    "caseId": 14436
    "severity": 2
    "startDate": 1698329500499
    "createdBy": "zsiem@rcm.lcl"
    "_id": "~1754337480"
    "status": "Resolved"
    "resolutionStatus": "TruePositive"
    tags:
      1. "Sensor:name="Окружная администрация г. Якутска""
      2. "Sensor:id="310052""
      3. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      4. "tlp:amber"
      5. "svo:other"
    stats:
    "tlp": 2
    "pap": 2
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698267669000
        "order": 0
      last-time:
        "date": 1698267969000
        "order": 0
      ncircc-class-attack:
        "string": "Попытки эксплуатации уязвимости;attack"
        "order": 0
    "updatedBy": "zsiem@rcm.lcl"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-1`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение PHP-кода`

Описание: `Внедрение PHP-кода. Целевые порты: 80`

Отработало на СОА: 
- **`310052`** Окружная администрация г. Якутска, Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:01:09`**
- Время окончания: **`26.10.2023 00:06:09`**
- **IP из домашней подсети**

1. **`46.48.133.183`**
- **IP из внешней подсети**

1. **`46.26.214.80`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99010701`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection in http-body die(@md5
2. РП: **`99010699`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection die(@md5(HellovBulletin))

"
    "impactStatus": "NoImpact"
    "createdAt": 1698329500520
    "updatedAt": 1698329532304
    "_type": "case"
    "flag": false
    "owner": "zsiem@rcm.lcl"
    permissions:
    "id": "~1754337480"
    "title": "Внедрение PHP-кода"
    "endDate": 1698329532257
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
  "organisationId": "~4136"
  "operation": "update"
  details:
    "impactStatus": "NoImpact"
    "endDate": 1698329532257
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698267669000
        "order": 0
      last-time:
        "date": 1698267969000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
  "startDate": 1698329532312
  "organisation": "RCM_DFO"
observables:
  1.
    reports:
    "_createdAt": 1698329525776
    extraData:
    "startDate": 1698329525776
    "_id": "~1508184064"
    "ioc": false
    "dataType": "snort_sid"
    "sighted": false
    "_type": "Observable"
    "data": "99010701,99010699"
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    tags:
      1. "snort"
  2.
    "dataType": "ip"
    "sighted": false
    "startDate": 1698329525750
    "_type": "Observable"
    "tlp": 2
    "_id": "~1426931776"
    "data": "46.26.214.80"
    extraData:
    reports:
    "_createdAt": 1698329525750
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": true
    tags:
      1. "external"
  3.
    tags:
      1. "home"
    "_id": "~4493123824"
    "_type": "Observable"
    reports:
    "tlp": 2
    "sighted": false
    "startDate": 1698329525723
    "_createdBy": "zsiem@rcm.lcl"
    "data": "46.48.133.183"
    "ioc": false
    "_createdAt": 1698329525723
    "dataType": "ip_home"
    extraData:
ttp:
  1.
    "occurDate": 1698267669000
    "patternId": "T1059"
    "tactic": "execution"
    "_createdAt": 1698329529855
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1754341576"
    extraData:
      pattern:
        "_type": "Pattern"
        extraData:
        "patternId": "T1059"
        "patternType": "attack-pattern"
        "url": "https://attack.mitre.org/techniques/T1059"
        dataSources:
          1. "Command: Command Execution"
          2. "Process: Process Creation"
          3. "Module: Module Load"
          4. "Script: Script Execution"
        "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script."
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "_createdAt": 1633310376063
        "_id": "~4448296"
        "name": "Command and Scripting Interpreter"
        "remoteSupport": false
        systemRequirements:
        tactics:
          1. "execution"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells."
        permissionsRequired:
          1. "User"
        "revoked": false
        "version": "2.1"
  2.
    "occurDate": 1698267669000
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329529085
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493127920"
    extraData:
      pattern:
        permissionsRequired:
        platforms:
          1. "PRE"
        "remoteSupport": false
        systemRequirements:
        "version": "1.0"
        "_createdAt": 1633310543738
        "_type": "Pattern"
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        tactics:
          1. "resource-development"
        dataSources:
        "name": "Vulnerabilities"
        "revoked": false
        "patternId": "T1588.006"
        "patternType": "attack-pattern"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        extraData:
        "_id": "~45945024"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "url": "https://attack.mitre.org/techniques/T1588/006"
      patternParent:
        "_type": "Pattern"
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "patternType": "attack-pattern"
        permissionsRequired:
        platforms:
          1. "PRE"
        dataSources:
        defenseBypassed:
        "revoked": false
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        extraData:
        systemRequirements:
        tactics:
          1. "resource-development"
        "_createdAt": 1633310408517
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "name": "Obtain Capabilities"
        "patternId": "T1588"
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588"
        "version": "1.0"
  3.
    "occurDate": 1698267669000
    "patternId": "T1190"
    "tactic": "initial-access"
    "_createdAt": 1698329529489
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493136112"
    extraData:
      pattern:
        "url": "https://attack.mitre.org/techniques/T1190"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        "patternId": "T1190"
        systemRequirements:
        tactics:
          1. "initial-access"
        "version": "2.3"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "name": "Exploit Public-Facing Application"
        "patternType": "attack-pattern"
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        "_createdAt": 1633310390294
        "_type": "Pattern"
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        permissionsRequired:
        "remoteSupport": false
        "_id": "~45563984"
        extraData:
        "revoked": false


2023/10/26 14:12:19 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361812"
  object:
    "_type": "case"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-2`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение PHP-кода`

Описание: `Внедрение PHP-кода. Целевые порты: 80`

Отработало на СОА: 
- **`310010`** Правительство Камчатского края, Установлен: Камчатский край, Петропавловск-Камчатский



**Полное описание события IDS:**

- Время начала: **`26.10.2023 13:23:37`**
- Время окончания: **`26.10.2023 14:35:17`**
- **IP из домашней подсети**

1. **`77.82.148.30`**
- **IP из внешней подсети**

1. **`36.94.137.167`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99010701`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection in http-body die(@md5
2. РП: **`99010699`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection die(@md5(HellovBulletin))

"
    tags:
      1. "Sensor:name="Правительство Камчатского края""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "Sensor:id="310010""
      4. "tlp:amber"
      5. "svo:other"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "owner": "zsiem@rcm.lcl"
    "createdAt": 1698329537460
    "updatedAt": 1698329567331
    customFields:
      class-attack:
        "string": "Exploit"
        "order": 0
      first-time:
        "date": 1698315817000
        "order": 0
      last-time:
        "date": 1698320117000
        "order": 0
      ncircc-class-attack:
        "string": "Попытки эксплуатации уязвимости;attack"
        "order": 0
    "createdBy": "zsiem@rcm.lcl"
    "tlp": 2
    "startDate": 1698329537444
    "status": "Resolved"
    "id": "~2123636912"
    "resolutionStatus": "TruePositive"
    "caseId": 14437
    "pap": 2
    "severity": 2
    "endDate": 1698329567278
    "impactStatus": "NoImpact"
    stats:
    "updatedBy": "zsiem@rcm.lcl"
    "title": "Внедрение PHP-кода"
    permissions:
    "_id": "~2123636912"
    "flag": false
  "organisationId": "~4136"
  "objectType": "case"
  "objectId": "~2123636912"
  "rootId": "~2123636912"
  "startDate": 1698329567339
  "organisation": "RCM_DFO"
  "operation": "update"
  details:
    customFields:
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698315817000
        "order": 0
      last-time:
        "date": 1698320117000
        "order": 0
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329567278
  "base": true
observables:
  1.
    "tlp": 2
    "_type": "Observable"
    "data": "77.82.148.30"
    extraData:
    "ioc": false
    "_id": "~4493156592"
    "dataType": "ip_home"
    "sighted": false
    "startDate": 1698329562103
    tags:
      1. "home"
    "_createdAt": 1698329562103
    reports:
    "_createdBy": "zsiem@rcm.lcl"
  2.
    "_createdBy": "zsiem@rcm.lcl"
    tags:
      1. "external"
    "_id": "~4493152496"
    "_createdAt": 1698329562052
    "data": "36.94.137.167"
    "dataType": "ip"
    "ioc": true
    "tlp": 2
    "_type": "Observable"
    extraData:
    reports:
    "sighted": false
    "startDate": 1698329562052
  3.
    "_createdAt": 1698329562078
    "_id": "~1216012472"
    "dataType": "snort_sid"
    extraData:
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "data": "99010701,99010699"
    "sighted": false
    tags:
      1. "snort"
    "ioc": false
    reports:
    "startDate": 1698329562078
ttp:
  1.
    "occurDate": 1698315817000
    "patternId": "T1059"
    "tactic": "execution"
    "_createdAt": 1698329565947
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216028856"
    extraData:
      pattern:
        "_id": "~4448296"
        dataSources:
          1. "Command: Command Execution"
          2. "Process: Process Creation"
          3. "Module: Module Load"
          4. "Script: Script Execution"
        tactics:
          1. "execution"
        "url": "https://attack.mitre.org/techniques/T1059"
        "name": "Command and Scripting Interpreter"
        "patternId": "T1059"
        "patternType": "attack-pattern"
        "_createdAt": 1633310376063
        defenseBypassed:
        "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells."
        "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script."
        extraData:
        permissionsRequired:
          1. "User"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "revoked": false
        systemRequirements:
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "remoteSupport": false
        "version": "2.1"
  2.
    "occurDate": 1698315817000
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329565028
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1426952256"
    extraData:
      pattern:
        "_createdBy": "admin@thehive.local"
        "remoteSupport": false
        "revoked": false
        "_createdAt": 1633310543738
        "patternId": "T1588.006"
        "patternType": "attack-pattern"
        defenseBypassed:
        dataSources:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        "name": "Vulnerabilities"
        permissionsRequired:
        systemRequirements:
        tactics:
          1. "resource-development"
        "version": "1.0"
        "_type": "Pattern"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        extraData:
        platforms:
          1. "PRE"
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "_id": "~45945024"
      patternParent:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternId": "T1588"
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        "_createdAt": 1633310408517
        "_type": "Pattern"
        defenseBypassed:
        "url": "https://attack.mitre.org/techniques/T1588"
        "name": "Obtain Capabilities"
        "version": "1.0"
        extraData:
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        permissionsRequired:
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        dataSources:
  3.
    "tactic": "initial-access"
    "_createdAt": 1698329565582
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493160688"
    extraData:
      pattern:
        "_createdAt": 1633310390294
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        "patternId": "T1190"
        "patternType": "attack-pattern"
        "version": "2.3"
        "remoteSupport": false
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1190"
        "_id": "~45563984"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        extraData:
        "name": "Exploit Public-Facing Application"
        systemRequirements:
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        defenseBypassed:
        permissionsRequired:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        tactics:
          1. "initial-access"
    "occurDate": 1698315817000
    "patternId": "T1190"


2023/10/26 14:12:55 	---------------
	EVENTS:
event:
  "objectId": "~1216045240"
  "startDate": 1698329603162
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361840"
  object:
    "_type": "case"
    tags:
      1. "Sensor:id="310040""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "Sensor:name="ФГБОУ ВО «Тихоокеанский государственный университет»""
      4. "tlp:amber"
      5. "svo:other"
    "tlp": 2
    "_id": "~1216045240"
    "createdBy": "zsiem@rcm.lcl"
    "pap": 2
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "order": 0
        "date": 1698315565000
      last-time:
        "date": 1698316017000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "endDate": 1698329603106
    "status": "Resolved"
    "caseId": 14438
    "title": "Внедрение PHP-кода"
    "severity": 2
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "createdAt": 1698329572671
    "updatedAt": 1698329603154
    "resolutionStatus": "TruePositive"
    "impactStatus": "NoImpact"
    "owner": "zsiem@rcm.lcl"
    stats:
    permissions:
    "id": "~1216045240"
    "flag": false
    "updatedBy": "zsiem@rcm.lcl"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-3`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение PHP-кода`

Описание: `Внедрение PHP-кода. Целевые порты: 80`

Отработало на СОА: 
- **`310040`** ФГБОУ ВО «Тихоокеанский государственный университет», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 13:19:25`**
- Время окончания: **`26.10.2023 13:26:57`**
- **IP из домашней подсети**

1. **`85.142.70.119`**
- **IP из внешней подсети**

1. **`125.166.12.25`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99010701`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection in http-body die(@md5
2. РП: **`99010699`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection die(@md5(HellovBulletin))

"
    "startDate": 1698329572653
  "operation": "update"
  details:
    "endDate": 1698329603106
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698315565000
        "order": 0
      last-time:
        "date": 1698316017000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
  "objectType": "case"
  "base": true
  "rootId": "~1216045240"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
observables:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216053432"
    "_type": "Observable"
    "dataType": "ip_home"
    "tlp": 2
    "_createdAt": 1698329597491
    extraData:
    "ioc": false
    reports:
    "sighted": false
    "startDate": 1698329597491
    tags:
      1. "home"
    "data": "85.142.70.119"
  2.
    tags:
      1. "snort"
    "_id": "~4493172976"
    "dataType": "snort_sid"
    reports:
    "_createdAt": 1698329597470
    extraData:
    "sighted": false
    "data": "99010701,99010699"
    "startDate": 1698329597470
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "ioc": false
  3.
    tags:
      1. "external"
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216049336"
    reports:
    "sighted": false
    "startDate": 1698329597449
    "_createdAt": 1698329597449
    "_type": "Observable"
    "data": "125.166.12.25"
    "dataType": "ip"
    extraData:
    "ioc": true
ttp:
  1.
    extraData:
      pattern:
        "_id": "~45945024"
        defenseBypassed:
        platforms:
          1. "PRE"
        dataSources:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        "patternId": "T1588.006"
        extraData:
        "patternType": "attack-pattern"
        systemRequirements:
        tactics:
          1. "resource-development"
        "version": "1.0"
        "revoked": false
        "_createdAt": 1633310543738
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "name": "Vulnerabilities"
        permissionsRequired:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588/006"
      patternParent:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        permissionsRequired:
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1588"
        "_createdAt": 1633310408517
        "_type": "Pattern"
        "patternId": "T1588"
        "remoteSupport": false
        systemRequirements:
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        extraData:
        "name": "Obtain Capabilities"
        dataSources:
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        "version": "1.0"
        "_id": "~45645904"
    "occurDate": 1698315565000
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329600705
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216057528"
  2.
    "_id": "~1216061624"
    extraData:
      pattern:
        dataSources:
          1. "Command: Command Execution"
          2. "Process: Process Creation"
          3. "Module: Module Load"
          4. "Script: Script Execution"
        extraData:
        "patternType": "attack-pattern"
        tactics:
          1. "execution"
        "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script."
        "name": "Command and Scripting Interpreter"
        "remoteSupport": false
        "_createdAt": 1633310376063
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells."
        systemRequirements:
        "patternId": "T1059"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "revoked": false
        "url": "https://attack.mitre.org/techniques/T1059"
        "_id": "~4448296"
        permissionsRequired:
          1. "User"
        "version": "2.1"
    "occurDate": 1698315565000
    "patternId": "T1059"
    "tactic": "execution"
    "_createdAt": 1698329601420
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "_createdAt": 1698329601058
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1754362056"
    extraData:
      pattern:
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        "version": "2.3"
        "_createdAt": 1633310390294
        "_id": "~45563984"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        "patternId": "T1190"
        "patternType": "attack-pattern"
        permissionsRequired:
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        extraData:
        tactics:
          1. "initial-access"
        "_type": "Pattern"
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        "name": "Exploit Public-Facing Application"
        "url": "https://attack.mitre.org/techniques/T1190"
    "occurDate": 1698315565000
    "patternId": "T1190"
    "tactic": "initial-access"
"source": "rcmkha"


2023/10/26 14:13:31 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "startDate": 1698329639022
  "operation": "update"
  details:
    "impactStatus": "NoImpact"
    "endDate": 1698329638956
    customFields:
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698307566000
        "order": 0
      last-time:
        "date": 1698307984000
        "order": 0
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
  "objectId": "~935080096"
  "base": true
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  "objectType": "case"
  "rootId": "~935080096"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361867"
  object:
    tags:
      1. "Sensor:id="310009""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "Sensor:name="Правительство Республики Саха (Якутия)""
      4. "tlp:amber"
      5. "svo:other"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "owner": "zsiem@rcm.lcl"
    "caseId": 14439
    "title": "Внедрение PHP-кода"
    "endDate": 1698329638956
    "impactStatus": "NoImpact"
    "id": "~935080096"
    "createdAt": 1698329608475
    "status": "Resolved"
    "resolutionStatus": "TruePositive"
    "_id": "~935080096"
    "createdBy": "zsiem@rcm.lcl"
    "updatedBy": "zsiem@rcm.lcl"
    "severity": 2
    stats:
    "tlp": 2
    "pap": 2
    permissions:
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-4`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение PHP-кода`

Описание: `Внедрение PHP-кода. Целевые порты: 80`

Отработало на СОА: 
- **`310009`** Правительство Республики Саха (Якутия), Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 11:06:06`**
- Время окончания: **`26.10.2023 11:13:04`**
- **IP из домашней подсети**

1. **`91.214.172.55`**
- **IP из внешней подсети**

1. **`213.182.75.234`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99010701`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection in http-body die(@md5
2. РП: **`99010699`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection die(@md5(HellovBulletin))

"
    "updatedAt": 1698329639014
    "_type": "case"
    "startDate": 1698329608457
    "flag": false
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698307566000
        "order": 0
      last-time:
        "date": 1698307984000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
observables:
  1.
    reports:
    "startDate": 1698329633623
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": false
    "sighted": false
    tags:
      1. "snort"
    "_createdAt": 1698329633623
    "_id": "~935084192"
    "_type": "Observable"
    extraData:
    "data": "99010701,99010699"
    "dataType": "snort_sid"
  2.
    "dataType": "ip_home"
    extraData:
    reports:
    "data": "91.214.172.55"
    "ioc": false
    "_type": "Observable"
    tags:
      1. "home"
    "tlp": 2
    "_createdAt": 1698329633676
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~935088288"
    "sighted": false
    "startDate": 1698329633676
  3.
    "startDate": 1698329633650
    "ioc": true
    "sighted": false
    tags:
      1. "external"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216086200"
    "dataType": "ip"
    reports:
    "tlp": 2
    "_createdAt": 1698329633650
    "_type": "Observable"
    "data": "213.182.75.234"
    extraData:
ttp:
  1.
    "_createdAt": 1698329637297
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1426972736"
    extraData:
    "occurDate": 1698307566000
    "patternId": "T1190"
    "tactic": "initial-access"
  2.
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329636922
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1754386632"
    extraData:
      pattern:
        "_type": "Pattern"
        dataSources:
        defenseBypassed:
        "name": "Vulnerabilities"
        "patternType": "attack-pattern"
        "version": "1.0"
        "_createdAt": 1633310543738
        "_createdBy": "admin@thehive.local"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "patternId": "T1588.006"
        permissionsRequired:
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "remoteSupport": false
        tactics:
          1. "resource-development"
        "_id": "~45945024"
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        extraData:
        platforms:
          1. "PRE"
        "revoked": false
      patternParent:
        "_type": "Pattern"
        defenseBypassed:
        systemRequirements:
        "revoked": false
        "_createdAt": 1633310408517
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        extraData:
        "patternId": "T1588"
        permissionsRequired:
        "remoteSupport": false
        "version": "1.0"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        "url": "https://attack.mitre.org/techniques/T1588"
        dataSources:
        "name": "Obtain Capabilities"
        tactics:
          1. "resource-development"
    "occurDate": 1698307566000
  3.
    "patternId": "T1059"
    "tactic": "execution"
    "_createdAt": 1698329637636
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493193456"
    extraData:
      pattern:
        "_id": "~4448296"
        dataSources:
          1. "Command: Command Execution"
          2. "Process: Process Creation"
          3. "Module: Module Load"
          4. "Script: Script Execution"
        extraData:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1059"
        defenseBypassed:
        "patternId": "T1059"
        "patternType": "attack-pattern"
        permissionsRequired:
          1. "User"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        systemRequirements:
        tactics:
          1. "execution"
        "_type": "Pattern"
        "name": "Command and Scripting Interpreter"
        "_createdAt": 1633310376063
        "_createdBy": "admin@thehive.local"
        "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells."
        "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script."
        "revoked": false
        "version": "2.1"
    "occurDate": 1698307566000


2023/10/26 14:14:03 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "rootId": "~1427251328"
  "objectId": "~1427251328"
  "base": true
  "objectType": "case"
  "startDate": 1698329671420
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361896"
  object:
    permissions:
    "title": "Внедрение PHP-кода"
    "severity": 2
    "createdBy": "zsiem@rcm.lcl"
    "startDate": 1698329644469
    "endDate": 1698329671362
    "status": "Resolved"
    "owner": "zsiem@rcm.lcl"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "id": "~1427251328"
    "flag": false
    "tlp": 2
    "pap": 2
    "impactStatus": "NoImpact"
    "caseId": 14440
    "_id": "~1427251328"
    "createdAt": 1698329644490
    "updatedAt": 1698329671413
    "_type": "case"
    "updatedBy": "zsiem@rcm.lcl"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-5`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение PHP-кода`

Описание: `Внедрение PHP-кода. Целевые порты: 80`

Отработало на СОА: 
- **`310012`** Правительство Хабаровского края (ул. Карла Маркса, д. 58), Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 08:57:44`**
- Время окончания: **`26.10.2023 09:06:27`**
- **IP из домашней подсети**

1. **`91.233.247.177`**
- **IP из внешней подсети**

1. **`213.182.75.234`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99010701`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection in http-body die(@md5
2. РП: **`99010699`**, Сообщение: CLASSTYPE-FIX trojan-activity -> web-application-attack NCIRCC PHP-Injection die(@md5(HellovBulletin))

"
    tags:
      1. "Sensor:id="310012""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "tlp:amber"
      4. "svo:other"
      5. "Sensor:name="Правительство Хабаровского края (ул. Карла Маркса, д. 58)""
    stats:
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698299864000
        "order": 0
      last-time:
        "order": 0
        "date": 1698300387000
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "resolutionStatus": "TruePositive"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  "operation": "update"
  details:
    "endDate": 1698329671362
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698299864000
        "order": 0
      last-time:
        "date": 1698300387000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
observables:
  1.
    "sighted": false
    "startDate": 1698329665718
    tags:
      1. "snort"
    "_id": "~2123681968"
    extraData:
    reports:
    "_type": "Observable"
    "_createdBy": "zsiem@rcm.lcl"
    "data": "99010701,99010699"
    "tlp": 2
    "_createdAt": 1698329665718
    "ioc": false
    "dataType": "snort_sid"
  2.
    "_type": "Observable"
    tags:
      1. "external"
    "dataType": "ip"
    extraData:
    reports:
    "sighted": false
    "tlp": 2
    "_createdAt": 1698329665743
    "data": "213.182.75.234"
    "ioc": true
    "startDate": 1698329665743
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1508245504"
  3.
    "_type": "Observable"
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "_createdAt": 1698329665693
    "dataType": "ip_home"
    reports:
    "sighted": false
    "startDate": 1698329665693
    tags:
      1. "home"
    "_id": "~1754398920"
    "data": "91.233.247.177"
    "ioc": false
ttp:
  1.
    "_id": "~935096480"
    extraData:
    "occurDate": 1698299864000
    "patternId": "T1059"
    "tactic": "execution"
    "_createdAt": 1698329669771
    "_createdBy": "zsiem@rcm.lcl"
  2.
    "_id": "~1216118968"
    extraData:
      pattern:
        "_type": "Pattern"
        extraData:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        "revoked": false
        "_id": "~45563984"
        "patternId": "T1190"
        "patternType": "attack-pattern"
        "_createdAt": 1633310390294
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        "name": "Exploit Public-Facing Application"
        permissionsRequired:
        "remoteSupport": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1190"
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        defenseBypassed:
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        tactics:
          1. "initial-access"
        "version": "2.3"
    "occurDate": 1698299864000
    "patternId": "T1190"
    "tactic": "initial-access"
    "_createdAt": 1698329669404
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "tactic": "resource-development"
    "_createdAt": 1698329669011
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493218032"
    extraData:
      pattern:
        "_createdAt": 1633310543738
        "name": "Vulnerabilities"
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "version": "1.0"
        dataSources:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        "patternType": "attack-pattern"
        permissionsRequired:
        platforms:
          1. "PRE"
        "remoteSupport": false
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        extraData:
        tactics:
          1. "resource-development"
        "_id": "~45945024"
        "_type": "Pattern"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "patternId": "T1588.006"
        "revoked": false
        systemRequirements:
      patternParent:
        platforms:
          1. "PRE"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "resource-development"
        "version": "1.0"
        "_createdAt": 1633310408517
        defenseBypassed:
        extraData:
        "url": "https://attack.mitre.org/techniques/T1588"
        "name": "Obtain Capabilities"
        "patternType": "attack-pattern"
        permissionsRequired:
        "patternId": "T1588"
        systemRequirements:
        "_id": "~45645904"
        dataSources:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
    "occurDate": 1698299864000
    "patternId": "T1588.006"


2023/10/26 14:14:38 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361926"
  object:
    "_type": "case"
    "startDate": 1698329676812
    "resolutionStatus": "TruePositive"
    customFields:
      first-time:
        "date": 1698282302000
        "order": 0
      last-time:
        "date": 1698282402000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "order": 0
        "string": "Exploit"
    "id": "~1216143544"
    "createdAt": 1698329676839
    "endDate": 1698329706916
    "status": "Resolved"
    "_id": "~1216143544"
    "flag": false
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "title": "Эксплуатация уязвимостей системы управления контентом сайта"
    "owner": "zsiem@rcm.lcl"
    permissions:
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-6`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Эксплуатация уязвимостей системы управления контентом сайта`

Описание: `Эксплуатация уязвимостей системы управления контентом сайта. Целевые порты: 80`

Отработало на СОА: 
- **`310038`** Хабаровский краевой фонд обязательного медицинского страхования, Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 04:05:02`**
- Время окончания: **`26.10.2023 04:06:42`**
- **IP из домашней подсети**

1. **`85.15.65.130`**
- **IP из внешней подсети**

1. **`65.108.40.25`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`2025646`**, Сообщение: ET WEB_SPECIFIC_APPS [eSentire] Drupalgeddon2 <8.3.9 <8.4.6 <8.5.1 RCE Through Registration Form (CVE-2018-7600)

"
    "impactStatus": "NoImpact"
    "tlp": 2
    stats:
    "updatedAt": 1698329706977
    "caseId": 14441
    tags:
      1. "Sensor:id="310038""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "Sensor:name="Хабаровский краевой фонд обязательного медицинского страхования""
      4. "tlp:amber"
      5. "svo:other"
    "createdBy": "zsiem@rcm.lcl"
    "updatedBy": "zsiem@rcm.lcl"
    "severity": 2
    "pap": 2
  "organisationId": "~4136"
  "operation": "update"
  details:
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329706916
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698282302000
        "order": 0
      last-time:
        "date": 1698282402000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
  "objectId": "~1216143544"
  "startDate": 1698329706985
  "objectType": "case"
  "base": true
  "rootId": "~1216143544"
  "organisation": "RCM_DFO"
observables:
  1.
    "data": "65.108.40.25"
    "_type": "Observable"
    "ioc": true
    "sighted": false
    "startDate": 1698329700260
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    reports:
    "dataType": "ip"
    "_id": "~935100576"
    tags:
      1. "external"
    "tlp": 2
    "_createdAt": 1698329700260
  2.
    "_type": "Observable"
    reports:
    "startDate": 1698329700233
    "tlp": 2
    "_createdAt": 1698329700233
    "data": "85.15.65.130"
    "dataType": "ip_home"
    "ioc": false
    "sighted": false
    tags:
      1. "home"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1426993216"
    extraData:
  3.
    "dataType": "snort_sid"
    extraData:
    "startDate": 1698329700286
    "data": "2025646"
    reports:
    "ioc": false
    "sighted": false
    "tlp": 2
    tags:
      1. "snort"
    "_createdAt": 1698329700286
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~935104672"
    "_type": "Observable"
ttp:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216151736"
    extraData:
      pattern:
        dataSources:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "name": "Vulnerabilities"
        tactics:
          1. "resource-development"
        "version": "1.0"
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        "patternType": "attack-pattern"
        systemRequirements:
        "_createdAt": 1633310543738
        "_type": "Pattern"
        defenseBypassed:
        permissionsRequired:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "_createdBy": "admin@thehive.local"
        "_id": "~45945024"
        extraData:
        "patternId": "T1588.006"
        platforms:
          1. "PRE"
        "revoked": false
      patternParent:
        extraData:
        systemRequirements:
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "name": "Obtain Capabilities"
        platforms:
          1. "PRE"
        "_id": "~45645904"
        dataSources:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternId": "T1588"
        permissionsRequired:
        "remoteSupport": false
        "revoked": false
        "_createdAt": 1633310408517
        "_type": "Pattern"
        "url": "https://attack.mitre.org/techniques/T1588"
        "patternType": "attack-pattern"
        "version": "1.0"
    "occurDate": 1698282302000
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329704879
  2.
    "_id": "~2123698352"
    extraData:
      patternParent:
        "_createdAt": 1633310408517
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternType": "attack-pattern"
        tactics:
          1. "resource-development"
        "version": "1.0"
        "_id": "~45645904"
        permissionsRequired:
        "remoteSupport": false
        "url": "https://attack.mitre.org/techniques/T1588"
        dataSources:
        defenseBypassed:
        "name": "Obtain Capabilities"
        platforms:
          1. "PRE"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        extraData:
        "patternId": "T1588"
        "revoked": false
        systemRequirements:
      pattern:
        "url": "https://attack.mitre.org/techniques/T1588/005"
        "version": "1.0"
        "_createdAt": 1633310474490
        "_type": "Pattern"
        "name": "Exploits"
        "patternType": "attack-pattern"
        "remoteSupport": false
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        defenseBypassed:
        "patternId": "T1588.005"
        dataSources:
        "detection": "
Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the use of exploits (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        extraData:
        permissionsRequired:
        platforms:
          1. "PRE"
        "_id": "~4747376"
        "description": "Adversaries may buy, steal, or download exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than developing their own exploits, an adversary may find/modify exploits from online or purchase them from exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying)

In addition to downloading free exploits from the internet, adversaries may purchase exploits from third-party entities. Third-party entities can include technology companies that specialize in exploit development, criminal marketplaces (including exploit kits), or from individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) In addition to purchasing exploits, adversaries may steal and repurpose exploits from third-party entities (including other adversaries).(Citation: TempertonDarkHotel)

An adversary may monitor exploit provider forums to understand the state of existing, as well as newly discovered, exploits. There is usually a delay between when an exploit is discovered and when it is made public. An adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation.

Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "revoked": false
        systemRequirements:
    "occurDate": 1698282302000
    "patternId": "T1588.005"
    "tactic": "resource-development"
    "_createdAt": 1698329704512
    "_createdBy": "zsiem@rcm.lcl"
  3.
    "tactic": "execution"
    "_createdAt": 1698329705635
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2123702448"
    extraData:
      pattern:
        dataSources:
          1. "Command: Command Execution"
          2. "Process: Process Creation"
          3. "Module: Module Load"
          4. "Script: Script Execution"
        defenseBypassed:
        "url": "https://attack.mitre.org/techniques/T1059"
        "_createdAt": 1633310376063
        "_createdBy": "admin@thehive.local"
        extraData:
        "name": "Command and Scripting Interpreter"
        "patternId": "T1059"
        "patternType": "attack-pattern"
        platforms:
          1. "Linux"
          2. "macOS"
          3. "Windows"
          4. "Network"
        "_id": "~4448296"
        "_type": "Pattern"
        "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.

If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.

Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script."
        permissionsRequired:
          1. "User"
        "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells."
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        tactics:
          1. "execution"
        "version": "2.1"
    "occurDate": 1698282302000
    "patternId": "T1059"
  4.
    "_createdAt": 1698329705291
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493230320"
    extraData:
    "occurDate": 1698282302000
    "patternId": "T1190"
    "tactic": "initial-access"


2023/10/26 14:15:14 	---------------
	EVENTS:
observables:
  1.
    "tlp": 2
    "_id": "~2123710640"
    "data": "79.124.8.3"
    tags:
      1. "external"
    "ioc": true
    "startDate": 1698329738426
    "_createdAt": 1698329738426
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    reports:
    "_createdBy": "zsiem@rcm.lcl"
    "sighted": false
  2.
    "sighted": false
    "tlp": 2
    "ioc": false
    "_type": "Observable"
    "data": "84.237.111.10"
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "_id": "~1216188600"
    "dataType": "ip_home"
    reports:
    "startDate": 1698329738463
    tags:
      1. "home"
    "_createdAt": 1698329738463
  3.
    "_createdAt": 1698329738445
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "snort_sid"
    reports:
    "_type": "Observable"
    "sighted": false
    tags:
      1. "snort"
    "_id": "~1216184504"
    "startDate": 1698329738445
    "data": "2014020"
    extraData:
    "ioc": false
    "tlp": 2
ttp:
  1.
    "_createdAt": 1698329741450
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493246704"
    extraData:
      pattern:
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials."
        "revoked": false
        systemRequirements:
        tactics:
          1. "credential-access"
        "capecId": "CAPEC-49"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625."
        "patternType": "attack-pattern"
        "version": "1.2"
        "_type": "Pattern"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        "name": "Password Guessing"
        "_createdBy": "admin@thehive.local"
        "url": "https://attack.mitre.org/techniques/T1110/001"
        extraData:
        "patternId": "T1110.001"
        permissionsRequired:
          1. "User"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "remoteSupport": false
        "_createdAt": 1633310505765
        "_id": "~4923432"
        defenseBypassed:
      patternParent:
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network."
        "patternType": "attack-pattern"
        tactics:
          1. "credential-access"
        "_createdAt": 1633310373843
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes."
        "name": "Brute Force"
        "patternId": "T1110"
        "_createdBy": "admin@thehive.local"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "revoked": false
        extraData:
        "_type": "Pattern"
        "capecId": "CAPEC-49"
        defenseBypassed:
        permissionsRequired:
          1. "User"
        "remoteSupport": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1110"
        "_id": "~4555000"
        "version": "2.2"
    "occurDate": 1698278409000
    "patternId": "T1110.001"
    "tactic": "credential-access"
"source": "rcmkha"
event:
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  details:
    "endDate": 1698329743187
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698278409000
        "order": 0
      last-time:
        "date": 1698280199000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
  "base": true
  "startDate": 1698329743245
  "rootId": "~1216180408"
  object:
    "status": "Resolved"
    permissions:
    "_id": "~1216180408"
    "impactStatus": "NoImpact"
    "resolutionStatus": "TruePositive"
    "title": "Перебор АИ через форму на сайте"
    "endDate": 1698329743187
    "pap": 2
    "severity": 2
    customFields:
      first-time:
        "date": 1698278409000
        "order": 0
      last-time:
        "date": 1698280199000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
      class-attack:
        "order": 0
        "string": "Подбор пароля"
    "createdAt": 1698329712488
    "caseId": 14442
    tags:
      1. "Sensor:id="310050""
      2. "NCIRCC:attack="Неудачные попытки авторизации""
      3. "tlp:amber"
      4. "svo:other"
      5. "Sensor:name="ФГБУН Федеральный исследовательский центр «Якутский научный центр СО РАН»""
    "flag": false
    "owner": "zsiem@rcm.lcl"
    "id": "~1216180408"
    "createdBy": "zsiem@rcm.lcl"
    "updatedAt": 1698329743237
    "tlp": 2
    "_type": "case"
    "updatedBy": "zsiem@rcm.lcl"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    stats:
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-7`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Перебор АИ через форму на сайте`

Описание: `Перебор АИ через форму на сайте. Целевые порты: 80`

Отработало на СОА: 
- **`310050`** ФГБУН Федеральный исследовательский центр «Якутский научный центр СО РАН», Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 03:00:09`**
- Время окончания: **`26.10.2023 03:29:59`**
- **IP из домашней подсети**

1. **`84.237.111.10`**
- **IP из внешней подсети**

1. **`79.124.8.3`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`2014020`**, Сообщение: ET WEB_SERVER Wordpress Login Bruteforcing Detected

"
    "startDate": 1698329712464
  "operation": "update"
  "objectType": "case"
  "objectId": "~1216180408"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361950"


2023/10/26 14:15:48 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "rootId": "~1427009600"
  object:
    "updatedAt": 1698329777236
    "severity": 2
    "endDate": 1698329777188
    "resolutionStatus": "TruePositive"
    "owner": "zsiem@rcm.lcl"
    "_type": "case"
    "id": "~1427009600"
    "caseId": 14443
    "tlp": 2
    "_id": "~1427009600"
    "pap": 2
    "title": "Подбор АИ по протоколу SSH"
    "impactStatus": "NoImpact"
    tags:
      1. "NCIRCC:attack="Неудачные попытки авторизации""
      2. "Sensor:name="Правительство Республики Саха (Якутия)""
      3. "tlp:amber"
      4. "svo:other"
      5. "Sensor:id="310078""
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-8`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Подбор АИ по протоколу SSH`

Описание: `Подбор АИ по протоколу SSH. Целевые порты: 22`

Отработало на СОА: 
- **`310078`** Правительство Республики Саха (Якутия), Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:00:27`**
- Время окончания: **`26.10.2023 16:37:50`**
- **IP из домашней подсети**

1. **`91.207.7.67`**
- **IP из внешней подсети**

1. **`46.101.124.52`**
2. **`58.220.56.66`**
3. **`107.170.213.107`**
4. **`153.37.193.154`**
5. **`139.150.69.142`**
6. **`218.200.44.237`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009570`**, Сообщение: NCCCI SSH brute force login attempt

"
    "startDate": 1698329748653
    "status": "Resolved"
    customFields:
      last-time:
        "order": 0
        "date": 1698327470000
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267627000
        "order": 0
    stats:
    permissions:
    "updatedBy": "zsiem@rcm.lcl"
    "createdAt": 1698329748676
    "flag": false
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "createdBy": "zsiem@rcm.lcl"
  "operation": "update"
  details:
    "endDate": 1698329777188
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267627000
        "order": 0
      last-time:
        "date": 1698327470000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
  "objectType": "case"
  "objectId": "~1427009600"
  "base": true
  "startDate": 1698329777243
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:361977"
observables:
  1.
    "_createdAt": 1698329772950
    "_type": "Observable"
    "dataType": "ip"
    tags:
      1. "external"
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216233656"
    "ioc": true
    "data": "107.170.213.107"
    extraData:
    reports:
    "sighted": false
    "tlp": 2
    "startDate": 1698329772950
  2.
    "data": "91.207.7.67"
    reports:
    "startDate": 1698329772928
    "tlp": 2
    "sighted": false
    "_createdAt": 1698329772928
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    extraData:
    tags:
      1. "home"
    "_id": "~1427296384"
    "dataType": "ip_home"
    "ioc": false
  3.
    "startDate": 1698329772908
    "data": "153.37.193.154"
    tags:
      1. "external"
    "tlp": 2
    "sighted": false
    "ioc": true
    reports:
    "_id": "~4493271280"
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    "_createdAt": 1698329772908
  4.
    "data": "218.200.44.237"
    tags:
      1. "external"
    "_createdAt": 1698329772961
    "_id": "~935129248"
    reports:
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    "sighted": false
    "startDate": 1698329772961
    "ioc": true
    "tlp": 2
  5.
    "_createdAt": 1698329773002
    reports:
    "_id": "~4493275376"
    extraData:
    tags:
      1. "external"
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "data": "139.150.69.142"
    "dataType": "ip"
    "startDate": 1698329773002
    "_type": "Observable"
    "ioc": true
    "sighted": false
  6.
    "_id": "~935125152"
    "_type": "Observable"
    "dataType": "ip"
    "tlp": 2
    "startDate": 1698329772939
    tags:
      1. "external"
    "_createdAt": 1698329772939
    "data": "58.220.56.66"
    extraData:
    "ioc": true
    reports:
    "sighted": false
    "_createdBy": "zsiem@rcm.lcl"
  7.
    tags:
      1. "external"
    "_createdAt": 1698329772990
    "data": "46.101.124.52"
    extraData:
    "tlp": 2
    reports:
    "sighted": false
    "_id": "~2123727024"
    "dataType": "ip"
    "ioc": true
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "startDate": 1698329772990
  8.
    "_createdBy": "zsiem@rcm.lcl"
    "data": "99009570"
    reports:
    "_id": "~935133344"
    "startDate": 1698329772977
    "_type": "Observable"
    extraData:
    "ioc": false
    tags:
      1. "snort"
    "tlp": 2
    "_createdAt": 1698329772977
    "dataType": "snort_sid"
    "sighted": false
ttp:
  1.
    "_createdAt": 1698329775947
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1427300480"
    extraData:
      patternParent:
        extraData:
        "patternType": "attack-pattern"
        "version": "2.2"
        "_createdAt": 1633310373843
        "_createdBy": "admin@thehive.local"
        "capecId": "CAPEC-49"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes."
        "url": "https://attack.mitre.org/techniques/T1110"
        "_type": "Pattern"
        defenseBypassed:
        "name": "Brute Force"
        "revoked": false
        systemRequirements:
        "_id": "~4555000"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network."
        "patternId": "T1110"
        permissionsRequired:
          1. "User"
        "remoteSupport": false
        tactics:
          1. "credential-access"
      pattern:
        "patternType": "attack-pattern"
        permissionsRequired:
          1. "User"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        systemRequirements:
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625."
        "name": "Password Guessing"
        "patternId": "T1110.001"
        "url": "https://attack.mitre.org/techniques/T1110/001"
        "_id": "~4923432"
        tactics:
          1. "credential-access"
        extraData:
        "remoteSupport": false
        "_createdAt": 1633310505765
        "_type": "Pattern"
        "capecId": "CAPEC-49"
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials."
        "version": "1.2"
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        defenseBypassed:
        "revoked": false
    "occurDate": 1698267627000
    "patternId": "T1110.001"
    "tactic": "credential-access"


2023/10/26 14:16:22 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "operation": "update"
  "objectId": "~935145632"
  "startDate": 1698329810530
  object:
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "_id": "~935145632"
    "endDate": 1698329810467
    "status": "Resolved"
    "id": "~935145632"
    "tlp": 2
    "createdBy": "zsiem@rcm.lcl"
    "updatedAt": 1698329810512
    stats:
    "updatedBy": "zsiem@rcm.lcl"
    "createdAt": 1698329782559
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-9`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Подбор АИ по протоколу SSH`

Описание: `Подбор АИ по протоколу SSH. Целевые порты: 22`

Отработало на СОА: 
- **`310070`** Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:00:03`**
- Время окончания: **`26.10.2023 16:12:32`**
- **IP из домашней подсети**

1. **`194.190.44.12`**
- **IP из внешней подсети**

1. **`61.0.251.14`**
2. **`47.242.171.249`**
3. **`94.56.126.78`**
4. **`222.101.244.162`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009570`**, Сообщение: NCCCI SSH brute force login attempt
2. РП: **`46128557`**, Сообщение: HackTool.BruteForce.SSH.C&C

"
    tags:
      1. "Sensor:name="Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН»""
      2. "NCIRCC:attack="Неудачные попытки авторизации""
      3. "tlp:amber"
      4. "Sensor:id="310070""
      5. "svo:other"
    "pap": 2
    "owner": "zsiem@rcm.lcl"
    "caseId": 14444
    "startDate": 1698329782537
    "impactStatus": "NoImpact"
    "resolutionStatus": "TruePositive"
    "flag": false
    permissions:
    "title": "Подбор АИ по протоколу SSH"
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267603000
        "order": 0
      last-time:
        "date": 1698325952000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
    "_type": "case"
    "severity": 2
  "organisationId": "~4136"
  details:
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329810467
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267603000
        "order": 0
      last-time:
        "date": 1698325952000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
  "objectType": "case"
  "base": true
  "rootId": "~935145632"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362002"
  "organisation": "RCM_DFO"
observables:
  1.
    "_createdAt": 1698329806010
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1427030080"
    "_type": "Observable"
    "ioc": true
    reports:
    "sighted": false
    "tlp": 2
    "data": "47.242.171.249"
    "dataType": "ip"
    tags:
      1. "external"
    extraData:
    "startDate": 1698329806010
  2.
    "dataType": "ip"
    "sighted": false
    "startDate": 1698329806115
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "data": "222.101.244.162"
    "ioc": true
    reports:
    "_id": "~1216266424"
    tags:
      1. "external"
    "_createdAt": 1698329806115
    "_type": "Observable"
    extraData:
  3.
    "_id": "~1216258232"
    "_type": "Observable"
    "sighted": false
    "_createdAt": 1698329806079
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": false
    "tlp": 2
    "data": "99009570,46128557"
    extraData:
    reports:
    tags:
      1. "snort"
    "dataType": "snort_sid"
    "startDate": 1698329806079
  4.
    "sighted": false
    tags:
      1. "external"
    "_type": "Observable"
    "data": "94.56.126.78"
    reports:
    "tlp": 2
    "dataType": "ip"
    extraData:
    "_id": "~1216262328"
    "startDate": 1698329806096
    "ioc": true
    "_createdAt": 1698329806096
    "_createdBy": "zsiem@rcm.lcl"
  5.
    "data": "194.190.44.12"
    "ioc": false
    "sighted": false
    tags:
      1. "home"
    "tlp": 2
    "_createdAt": 1698329806035
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493308144"
    extraData:
    reports:
    "_type": "Observable"
    "dataType": "ip_home"
    "startDate": 1698329806035
  6.
    "sighted": false
    "tlp": 2
    extraData:
    "_createdBy": "zsiem@rcm.lcl"
    "data": "61.0.251.14"
    "ioc": true
    reports:
    "startDate": 1698329806054
    tags:
      1. "external"
    "_createdAt": 1698329806054
    "_id": "~1216254136"
    "_type": "Observable"
    "dataType": "ip"
ttp:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~2123735216"
    extraData:
      pattern:
        "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625."
        "name": "Password Guessing"
        "remoteSupport": false
        "_id": "~4923432"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1110/001"
        "capecId": "CAPEC-49"
        "revoked": false
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials."
        extraData:
        "patternType": "attack-pattern"
        permissionsRequired:
          1. "User"
        "version": "1.2"
        "_createdBy": "admin@thehive.local"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        defenseBypassed:
        "patternId": "T1110.001"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        tactics:
          1. "credential-access"
        "_createdAt": 1633310505765
        "_type": "Pattern"
      patternParent:
        "_id": "~4555000"
        "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes."
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network."
        "patternId": "T1110"
        "patternType": "attack-pattern"
        "revoked": false
        "_type": "Pattern"
        "capecId": "CAPEC-49"
        "name": "Brute Force"
        systemRequirements:
        "_createdAt": 1633310373843
        "_createdBy": "admin@thehive.local"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        permissionsRequired:
          1. "User"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "version": "2.2"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        defenseBypassed:
        extraData:
        "remoteSupport": false
        tactics:
          1. "credential-access"
        "url": "https://attack.mitre.org/techniques/T1110"
    "occurDate": 1698267603000
    "patternId": "T1110.001"
    "tactic": "credential-access"
    "_createdAt": 1698329809089


2023/10/26 14:16:29 	---------------
	EVENTS:
"source": "rcmnvs"
event:
  details:
  "objectType": "case"
  "rootId": "~507953192"
  "requestId": "d685a18413e44f05:-44d33206:18aefaff560:-8000:374834"
  "organisation": "RCM"
  "operation": "update"
  "objectId": "~507953192"
  "base": false
  "startDate": 1698329817974
  object:
    "caseId": 9041
    "id": "~507953192"
    "_type": "case"
    "owner": "baa@rcm"
    permissions:
    "updatedBy": ""
    "updatedAt": 0
    "tlp": 2
    "pap": 2
    "status": "Open"
    "createdAt": 1698329817967
    "endDate": 0
    "impactStatus": ""
    "title": " Подбор АИ к к админ-панели CMS Wordpress"
    "description": "Описание:"
    "severity": 2
    "startDate": 1698372180000
    "resolutionStatus": ""
    "createdBy": "baa@rcm"
    "flag": false
    stats:
    "_id": "~507953192"
    tags:
      1. "rcmnvs:asod"
    "summary": ""
    customFields:
      class-attack:
        "order": 0
      ncircc-class-attack:
        "order": 1
  "organisationId": "~45296"
observables:
  1.
    "_createdAt": 1698329818133
    "data": "114.221.174.113"
    "_createdBy": "baa@rcm"
    "sighted": false
    "_id": "~98971768"
    "dataType": "ip"
    "ioc": true
    reports:
    "startDate": 1698329818133
    "_type": "Observable"
    extraData:
    tags:
      1. "external"
      2. "count="15""
      3. "geo:iso="CN""
      4. "geo:country="Китай""
    "tlp": 2
  2.
    "ioc": false
    "sighted": false
    tags:
      1. "home"
    "_id": "~139542632"
    "_type": "Observable"
    "tlp": 2
    "_createdBy": "baa@rcm"
    "startDate": 1698329818105
    extraData:
    "dataType": "ip_home"
    reports:
    "_createdAt": 1698329818105
    "data": "570050:217.79.61.93"
  3.
    "data": "2014020"
    extraData:
    "sighted": false
    tags:
      1. "snort"
    "_createdAt": 1698329818095
    "ioc": false
    reports:
    "startDate": 1698329818095
    "_type": "Observable"
    "_createdBy": "baa@rcm"
    "_id": "~98967672"
    "dataType": "snort_sid"
    "tlp": 2
ttp:


2023/10/26 14:16:57 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "operation": "update"
  "objectType": "case"
  "objectId": "~4493332720"
  "startDate": 1698329845385
  "rootId": "~4493332720"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362028"
  details:
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329845328
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267616000
        "order": 0
      last-time:
        "order": 0
        "date": 1698326154000
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
  "base": true
  object:
    "tlp": 2
    "id": "~4493332720"
    tags:
      1. "Sensor:name="Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН»""
      2. "NCIRCC:attack="Неудачные попытки авторизации""
      3. "tlp:amber"
      4. "Sensor:id="310070""
      5. "svo:other"
    "updatedAt": 1698329845378
    "title": "Подбор АИ по протоколу SSH"
    "severity": 2
    "resolutionStatus": "TruePositive"
    "pap": 2
    "_type": "case"
    stats:
    "createdBy": "zsiem@rcm.lcl"
    "_id": "~4493332720"
    "updatedBy": "zsiem@rcm.lcl"
    "owner": "zsiem@rcm.lcl"
    "flag": false
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    permissions:
    "caseId": 14445
    "startDate": 1698329815907
    "impactStatus": "NoImpact"
    "status": "Resolved"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-10`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Подбор АИ по протоколу SSH`

Описание: `Подбор АИ по протоколу SSH. Целевые порты: 22`

Отработало на СОА: 
- **`310070`** Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:00:16`**
- Время окончания: **`26.10.2023 16:15:54`**
- **IP из домашней подсети**

1. **`194.190.44.20`**
- **IP из внешней подсети**

1. **`111.7.172.14`**
2. **`103.162.188.212`**
3. **`223.82.106.158`**
4. **`58.16.91.119`**
5. **`39.107.101.125`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009570`**, Сообщение: NCCCI SSH brute force login attempt
2. РП: **`46128557`**, Сообщение: HackTool.BruteForce.SSH.C&C

"
    "endDate": 1698329845328
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267616000
        "order": 0
      last-time:
        "date": 1698326154000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
    "createdAt": 1698329815923
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
observables:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    tags:
      1. "external"
    "dataType": "ip"
    extraData:
    "tlp": 2
    "_createdAt": 1698329840310
    "_id": "~4493357296"
    "_type": "Observable"
    "ioc": true
    reports:
    "startDate": 1698329840310
    "data": "223.82.106.158"
    "sighted": false
  2.
    "_createdAt": 1698329840253
    "_type": "Observable"
    extraData:
    "ioc": false
    "sighted": false
    "tlp": 2
    "dataType": "ip_home"
    "startDate": 1698329840253
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493349104"
    "data": "194.190.44.20"
    reports:
    tags:
      1. "home"
  3.
    "_createdBy": "zsiem@rcm.lcl"
    "data": "111.7.172.14"
    tags:
      1. "external"
    "_createdAt": 1698329840185
    reports:
    "dataType": "ip"
    extraData:
    "ioc": true
    "sighted": false
    "tlp": 2
    "_id": "~1216291000"
    "_type": "Observable"
    "startDate": 1698329840185
  4.
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "ioc": false
    "sighted": false
    "startDate": 1698329840228
    tags:
      1. "snort"
    "_id": "~4493345008"
    "dataType": "snort_sid"
    reports:
    "tlp": 2
    "_createdAt": 1698329840228
    extraData:
    "data": "99009570,46128557"
  5.
    "_createdAt": 1698329840291
    tags:
      1. "external"
    "tlp": 2
    "data": "58.16.91.119"
    reports:
    "startDate": 1698329840291
    "_id": "~4493353200"
    "sighted": false
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    "ioc": true
  6.
    "sighted": false
    tags:
      1. "external"
    "tlp": 2
    extraData:
    "ioc": true
    "startDate": 1698329840272
    "_createdAt": 1698329840272
    "_type": "Observable"
    "dataType": "ip"
    "_createdBy": "zsiem@rcm.lcl"
    reports:
    "_id": "~1216295096"
    "data": "39.107.101.125"
  7.
    "_id": "~4493340912"
    "ioc": true
    reports:
    "_createdBy": "zsiem@rcm.lcl"
    "sighted": false
    tags:
      1. "external"
    "tlp": 2
    "data": "103.162.188.212"
    "_type": "Observable"
    "dataType": "ip"
    extraData:
    "startDate": 1698329840203
    "_createdAt": 1698329840203
ttp:
  1.
    extraData:
      pattern:
        extraData:
        "name": "Password Guessing"
        "patternType": "attack-pattern"
        "remoteSupport": false
        "revoked": false
        tactics:
          1. "credential-access"
        "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625."
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials."
        "version": "1.2"
        permissionsRequired:
          1. "User"
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "_createdBy": "admin@thehive.local"
        "patternId": "T1110.001"
        "capecId": "CAPEC-49"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        defenseBypassed:
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1110/001"
        "_createdAt": 1633310505765
        "_id": "~4923432"
        "_type": "Pattern"
      patternParent:
        "_createdAt": 1633310373843
        "name": "Brute Force"
        "patternType": "attack-pattern"
        permissionsRequired:
          1. "User"
        "remoteSupport": false
        tactics:
          1. "credential-access"
        "url": "https://attack.mitre.org/techniques/T1110"
        "_createdBy": "admin@thehive.local"
        "_id": "~4555000"
        "_type": "Pattern"
        defenseBypassed:
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network."
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        systemRequirements:
        "version": "2.2"
        "capecId": "CAPEC-49"
        "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes."
        extraData:
        "patternId": "T1110"
        "revoked": false
    "occurDate": 1698267616000
    "patternId": "T1110.001"
    "tactic": "credential-access"
    "_createdAt": 1698329843340
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~935157920"


2023/10/26 14:17:31 	---------------
	EVENTS:
ttp:
  1.
    "_createdAt": 1698329876762
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493385968"
    extraData:
      pattern:
        "_createdAt": 1633310505765
        "_createdBy": "admin@thehive.local"
        "patternType": "attack-pattern"
        permissionsRequired:
          1. "User"
        "remoteSupport": false
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "version": "1.2"
        "_type": "Pattern"
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        defenseBypassed:
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials."
        extraData:
        "name": "Password Guessing"
        "revoked": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1110/001"
        "_id": "~4923432"
        "capecId": "CAPEC-49"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.

Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625."
        "patternId": "T1110.001"
        tactics:
          1. "credential-access"
      patternParent:
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
        "remoteSupport": false
        tactics:
          1. "credential-access"
        "_id": "~4555000"
        defenseBypassed:
        "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes."
        permissionsRequired:
          1. "User"
        "capecId": "CAPEC-49"
        extraData:
        "name": "Brute Force"
        "patternId": "T1110"
        "patternType": "attack-pattern"
        "revoked": false
        systemRequirements:
        dataSources:
          1. "User Account: User Account Authentication"
          2. "Application Log: Application Log Content"
        "_createdBy": "admin@thehive.local"
        "_type": "Pattern"
        "capecUrl": "https://capec.mitre.org/data/definitions/49.html"
        "detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network."
        "url": "https://attack.mitre.org/techniques/T1110"
        "version": "2.2"
        "_createdAt": 1633310373843
    "occurDate": 1698267600000
    "patternId": "T1110.001"
    "tactic": "credential-access"
"source": "rcmkha"
event:
  "startDate": 1698329879718
  "rootId": "~1216315576"
  details:
    "endDate": 1698329879658
    customFields:
      class-attack:
        "string": "Подбор пароля"
        "order": 0
      first-time:
        "order": 0
        "date": 1698267600000
      last-time:
        "date": 1698327716000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Неудачные попытки авторизации;attack"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
  "objectId": "~1216315576"
  "base": true
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362053"
  object:
    "_id": "~1216315576"
    "createdAt": 1698329851515
    "updatedAt": 1698329879710
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "updatedBy": "zsiem@rcm.lcl"
    "impactStatus": "NoImpact"
    "resolutionStatus": "TruePositive"
    stats:
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-11`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Подбор АИ по протоколу SSH`

Описание: `Подбор АИ по протоколу SSH. Целевые порты: 22`

Отработало на СОА: 
- **`310070`** Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:00:00`**
- Время окончания: **`26.10.2023 16:41:56`**
- **IP из домашней подсети**

1. **`194.190.44.26`**
- **IP из внешней подсети**

1. **`218.38.19.9`**
2. **`123.13.196.104`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009570`**, Сообщение: NCCCI SSH brute force login attempt

"
    "startDate": 1698329851500
    customFields:
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      first-time:
        "date": 1698267600000
        "order": 0
      last-time:
        "date": 1698327716000
        "order": 0
      ncircc-class-attack:
        "string": "Неудачные попытки авторизации;attack"
        "order": 0
    "createdBy": "zsiem@rcm.lcl"
    "owner": "zsiem@rcm.lcl"
    permissions:
    "_type": "case"
    "flag": false
    "tlp": 2
    "status": "Resolved"
    "caseId": 14446
    "title": "Подбор АИ по протоколу SSH"
    "severity": 2
    "id": "~1216315576"
    "endDate": 1698329879658
    "pap": 2
    tags:
      1. "Sensor:name="Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН»""
      2. "NCIRCC:attack="Неудачные попытки авторизации""
      3. "tlp:amber"
      4. "Sensor:id="310070""
      5. "svo:other"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
  "operation": "update"
  "objectType": "case"
observables:
  1.
    "_id": "~1216327864"
    "data": "99009570"
    "ioc": false
    "dataType": "snort_sid"
    reports:
    "sighted": false
    "startDate": 1698329872695
    extraData:
    tags:
      1. "snort"
    "_createdAt": 1698329872695
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "tlp": 2
  2.
    "_type": "Observable"
    "sighted": false
    "tlp": 2
    reports:
    "_createdBy": "zsiem@rcm.lcl"
    "data": "218.38.19.9"
    "ioc": true
    "dataType": "ip"
    extraData:
    tags:
      1. "external"
    "_createdAt": 1698329872714
    "_id": "~1427341440"
    "startDate": 1698329872714
  3.
    "_id": "~1508306944"
    "_type": "Observable"
    "data": "194.190.44.26"
    "sighted": false
    "startDate": 1698329872669
    tags:
      1. "home"
    "tlp": 2
    "_createdAt": 1698329872669
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "ioc": false
    reports:
    "dataType": "ip_home"
  4.
    "_createdAt": 1698329872642
    "_id": "~1216323768"
    "dataType": "ip"
    extraData:
    reports:
    "sighted": false
    "tlp": 2
    "startDate": 1698329872642
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "data": "123.13.196.104"
    "ioc": true
    tags:
      1. "external"


2023/10/26 14:18:04 	---------------
	EVENTS:
"source": "rcmkha"
event:
  "organisation": "RCM_DFO"
  "objectType": "case"
  "objectId": "~1216344248"
  "base": true
  "rootId": "~1216344248"
  "organisationId": "~4136"
  "operation": "update"
  details:
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329912255
    customFields:
      class-attack:
        "order": 0
        "string": "SQL-injection"
      first-time:
        "date": 1698317187000
        "order": 0
      last-time:
        "date": 1698320613000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
  "startDate": 1698329912363
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362081"
  object:
    "severity": 2
    "_type": "case"
    "title": "Внедрение SQL-запроса"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-12`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение SQL-запроса`

Описание: `Внедрение SQL-запроса. Целевые порты: 80`

Отработало на СОА: 
- **`310067`** ФГБУН Институт вулканологии и сейсмологии ДВО РАН, Установлен: Камчатский край, Петропавловск-Камчатский



**Полное описание события IDS:**

- Время начала: **`26.10.2023 13:46:27`**
- Время окончания: **`26.10.2023 14:43:33`**
- **IP из домашней подсети**

1. **`62.76.193.104`**
- **IP из внешней подсети**

1. **`45.118.133.22`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`19439`**, Сообщение: SQL 1 = 1 - possible sql injection attempt

"
    tags:
      1. "Sensor:name="ФГБУН Институт вулканологии и сейсмологии ДВО РАН""
      2. "Sensor:id="310067""
      3. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      4. "tlp:amber"
      5. "svo:other"
    "status": "Resolved"
    "createdBy": "zsiem@rcm.lcl"
    "updatedBy": "zsiem@rcm.lcl"
    "createdAt": 1698329885027
    permissions:
    "caseId": 14447
    "tlp": 2
    "pap": 2
    "_id": "~1216344248"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    stats:
    "endDate": 1698329912255
    "resolutionStatus": "TruePositive"
    "owner": "zsiem@rcm.lcl"
    "id": "~1216344248"
    "startDate": 1698329885009
    "impactStatus": "NoImpact"
    "updatedAt": 1698329912303
    "flag": false
    customFields:
      class-attack:
        "order": 0
        "string": "SQL-injection"
      first-time:
        "date": 1698317187000
        "order": 0
      last-time:
        "date": 1698320613000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
observables:
  1.
    "_id": "~1427353728"
    tags:
      1. "external"
    "data": "45.118.133.22"
    extraData:
    "startDate": 1698329907779
    "tlp": 2
    "sighted": false
    "_createdAt": 1698329907779
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    "dataType": "ip"
    "ioc": true
    reports:
  2.
    "_id": "~1427357824"
    tags:
      1. "home"
    "_createdAt": 1698329907799
    "dataType": "ip_home"
    extraData:
    "ioc": false
    "sighted": false
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    reports:
    "_type": "Observable"
    "startDate": 1698329907799
    "data": "62.76.193.104"
  3.
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    reports:
    "sighted": false
    "ioc": false
    "startDate": 1698329907759
    "_type": "Observable"
    "data": "19439"
    extraData:
    "_createdAt": 1698329907759
    "_id": "~1427349632"
    tags:
      1. "snort"
    "dataType": "snort_sid"
ttp:
  1.
    extraData:
      pattern:
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1190"
        "_id": "~45563984"
        "_type": "Pattern"
        defenseBypassed:
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        "name": "Exploit Public-Facing Application"
        "patternId": "T1190"
        "remoteSupport": false
        "revoked": false
        "_createdAt": 1633310390294
        "_createdBy": "admin@thehive.local"
        "version": "2.3"
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        extraData:
        systemRequirements:
        tactics:
          1. "initial-access"
        "patternType": "attack-pattern"
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
    "occurDate": 1698317187000
    "patternId": "T1190"
    "tactic": "initial-access"
    "_createdAt": 1698329910934
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1754493128"
  2.
    "occurDate": 1698317187000
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329910540
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493406448"
    extraData:
      pattern:
        "_type": "Pattern"
        dataSources:
        "patternId": "T1588.006"
        "patternType": "attack-pattern"
        "remoteSupport": false
        "version": "1.0"
        "_createdAt": 1633310543738
        defenseBypassed:
        extraData:
        "name": "Vulnerabilities"
        systemRequirements:
        tactics:
          1. "resource-development"
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "_id": "~45945024"
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        permissionsRequired:
        platforms:
          1. "PRE"
        "_createdBy": "admin@thehive.local"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "revoked": false
      patternParent:
        platforms:
          1. "PRE"
        "remoteSupport": false
        "_type": "Pattern"
        defenseBypassed:
        extraData:
        "patternType": "attack-pattern"
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1588"
        "version": "1.0"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        dataSources:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "_createdAt": 1633310408517
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "revoked": false
        tactics:
          1. "resource-development"
        "name": "Obtain Capabilities"
        "patternId": "T1588"
        systemRequirements:


2023/10/26 14:18:39 	---------------
	EVENTS:
event:
  "objectType": "case"
  "objectId": "~1427066944"
  "base": true
  "startDate": 1698329947571
  object:
    "caseId": 14448
    customFields:
      class-attack:
        "order": 0
        "string": "SQL-injection"
      first-time:
        "date": 1698319162000
        "order": 0
      last-time:
        "date": 1698326538000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "id": "~1427066944"
    "_type": "case"
    "endDate": 1698329947519
    stats:
    "_id": "~1427066944"
    "startDate": 1698329917723
    "title": "Внедрение SQL-запроса"
    "tlp": 2
    "status": "Resolved"
    permissions:
    "flag": false
    tags:
      1. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      2. "Sensor:name="Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН»""
      3. "tlp:amber"
      4. "Sensor:id="310070""
      5. "svo:other"
    "pap": 2
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "updatedBy": "zsiem@rcm.lcl"
    "impactStatus": "NoImpact"
    "resolutionStatus": "TruePositive"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-13`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Внедрение SQL-запроса`

Описание: `Внедрение SQL-запроса. Целевые порты: 80`

Отработало на СОА: 
- **`310070`** Обособленное подразделение ФГБУН ХФИЦ ДВО РАН «Вычислительный центр ДВО РАН», Установлен: Хабаровский край, Хабаровск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 14:19:22`**
- Время окончания: **`26.10.2023 16:22:18`**
- **IP из домашней подсети**

1. **`194.190.44.21`**
- **IP из внешней подсети**

1. **`108.165.237.65`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`19439`**, Сообщение: SQL 1 = 1 - possible sql injection attempt

"
    "createdAt": 1698329917745
    "updatedAt": 1698329947563
    "severity": 2
    "owner": "zsiem@rcm.lcl"
    "createdBy": "zsiem@rcm.lcl"
  "organisation": "RCM_DFO"
  "operation": "update"
  details:
    customFields:
      first-time:
        "date": 1698319162000
        "order": 0
      last-time:
        "date": 1698326538000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "order": 0
        "string": "SQL-injection"
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329947519
  "organisationId": "~4136"
  "rootId": "~1427066944"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362109"
observables:
  1.
    "_createdBy": "zsiem@rcm.lcl"
    "data": "108.165.237.65"
    tags:
      1. "external"
    "_createdAt": 1698329941192
    "_type": "Observable"
    "dataType": "ip"
    "ioc": true
    "startDate": 1698329941192
    "_id": "~1427075136"
    extraData:
    reports:
    "sighted": false
    "tlp": 2
  2.
    "_createdAt": 1698329941165
    "data": "194.190.44.21"
    reports:
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1427370112"
    "_type": "Observable"
    "ioc": false
    "dataType": "ip_home"
    "sighted": false
    tags:
      1. "home"
    extraData:
    "startDate": 1698329941165
  3.
    "data": "19439"
    extraData:
    "sighted": false
    tags:
      1. "snort"
    "_createdAt": 1698329941136
    "startDate": 1698329941136
    "_id": "~2123780272"
    "ioc": false
    "tlp": 2
    "dataType": "snort_sid"
    "_type": "Observable"
    reports:
    "_createdBy": "zsiem@rcm.lcl"
ttp:
  1.
    "_id": "~1216356536"
    extraData:
      pattern:
        "_createdAt": 1633310390294
        "patternId": "T1190"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1190"
        "_type": "Pattern"
        defenseBypassed:
        "name": "Exploit Public-Facing Application"
        permissionsRequired:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        "revoked": false
        tactics:
          1. "initial-access"
        "version": "2.3"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        "remoteSupport": false
        "_createdBy": "admin@thehive.local"
        "_id": "~45563984"
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        extraData:
        "patternType": "attack-pattern"
    "occurDate": 1698319162000
    "patternId": "T1190"
    "tactic": "initial-access"
    "_createdAt": 1698329946204
    "_createdBy": "zsiem@rcm.lcl"
  2.
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698329945735
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1427374208"
    extraData:
      pattern:
        "name": "Vulnerabilities"
        "patternType": "attack-pattern"
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "_id": "~45945024"
        "_type": "Pattern"
        dataSources:
        defenseBypassed:
        systemRequirements:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        extraData:
        permissionsRequired:
        "revoked": false
        "version": "1.0"
        "_createdAt": 1633310543738
        "_createdBy": "admin@thehive.local"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        tactics:
          1. "resource-development"
        "patternId": "T1588.006"
        platforms:
          1. "PRE"
        "remoteSupport": false
      patternParent:
        "_createdAt": 1633310408517
        extraData:
        tactics:
          1. "resource-development"
        "url": "https://attack.mitre.org/techniques/T1588"
        "_type": "Pattern"
        defenseBypassed:
        "patternType": "attack-pattern"
        permissionsRequired:
        "revoked": false
        systemRequirements:
        "version": "1.0"
        "_id": "~45645904"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "name": "Obtain Capabilities"
        "_createdBy": "admin@thehive.local"
        dataSources:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "patternId": "T1588"
        platforms:
          1. "PRE"
        "remoteSupport": false
    "occurDate": 1698319162000
"source": "rcmkha"


2023/10/26 14:19:17 	---------------
	EVENTS:
observables:
  1.
    "_createdAt": 1698329977777
    "_id": "~1508352000"
    reports:
    "_type": "Observable"
    "data": "103.178.229.184"
    extraData:
    "tlp": 2
    "dataType": "ip"
    "sighted": false
    "startDate": 1698329977777
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": true
    tags:
      1. "external"
  2.
    "_createdAt": 1698329977821
    "_createdBy": "zsiem@rcm.lcl"
    "data": "103.180.146.2"
    "dataType": "ip"
    "tlp": 2
    "ioc": true
    reports:
    "sighted": false
    tags:
      1. "external"
    "_type": "Observable"
    extraData:
    "startDate": 1698329977821
    "_id": "~2123792560"
  3.
    "_createdAt": 1698329977753
    extraData:
    "ioc": false
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "snort_sid"
    "tlp": 2
    "_type": "Observable"
    "sighted": false
    "_id": "~2123788464"
    "data": "99009637"
    reports:
    "startDate": 1698329977753
    tags:
      1. "snort"
  4.
    "startDate": 1698329977802
    tags:
      1. "home"
    extraData:
    "ioc": false
    "sighted": false
    "tlp": 2
    "_createdAt": 1698329977802
    "_id": "~1508356096"
    "_type": "Observable"
    "data": "91.201.237.96"
    "_createdBy": "zsiem@rcm.lcl"
    "dataType": "ip_home"
    reports:
ttp:
  1.
    "patternId": "T1588.005"
    "tactic": "resource-development"
    "_createdAt": 1698329981425
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1216368824"
    extraData:
      pattern:
        "_createdAt": 1633310474490
        dataSources:
        "description": "Adversaries may buy, steal, or download exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than developing their own exploits, an adversary may find/modify exploits from online or purchase them from exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying)

In addition to downloading free exploits from the internet, adversaries may purchase exploits from third-party entities. Third-party entities can include technology companies that specialize in exploit development, criminal marketplaces (including exploit kits), or from individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) In addition to purchasing exploits, adversaries may steal and repurpose exploits from third-party entities (including other adversaries).(Citation: TempertonDarkHotel)

An adversary may monitor exploit provider forums to understand the state of existing, as well as newly discovered, exploits. There is usually a delay between when an exploit is discovered and when it is made public. An adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation.

Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        extraData:
        "patternId": "T1588.005"
        platforms:
          1. "PRE"
        "name": "Exploits"
        permissionsRequired:
        systemRequirements:
        defenseBypassed:
        "patternType": "attack-pattern"
        "version": "1.0"
        tactics:
          1. "resource-development"
        "url": "https://attack.mitre.org/techniques/T1588/005"
        "_createdBy": "admin@thehive.local"
        "_id": "~4747376"
        "_type": "Pattern"
        "detection": "
Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the use of exploits (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "remoteSupport": false
        "revoked": false
      patternParent:
        "_type": "Pattern"
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        platforms:
          1. "PRE"
        "_createdAt": 1633310408517
        "_createdBy": "admin@thehive.local"
        permissionsRequired:
        "remoteSupport": false
        tactics:
          1. "resource-development"
        "url": "https://attack.mitre.org/techniques/T1588"
        extraData:
        "patternType": "attack-pattern"
        "patternId": "T1588"
        "revoked": false
        systemRequirements:
        "_id": "~45645904"
        "name": "Obtain Capabilities"
        "version": "1.0"
        dataSources:
        defenseBypassed:
    "occurDate": 1698272139000
  2.
    "_createdAt": 1698329981817
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1508360192"
    extraData:
      pattern:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        extraData:
        "patternType": "attack-pattern"
        tactics:
          1. "resource-development"
        permissionsRequired:
        "remoteSupport": false
        systemRequirements:
        "version": "1.0"
        "_createdAt": 1633310543738
        dataSources:
        defenseBypassed:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "_createdBy": "admin@thehive.local"
        "_id": "~45945024"
        "name": "Vulnerabilities"
        "patternId": "T1588.006"
        "_type": "Pattern"
        platforms:
          1. "PRE"
        "revoked": false
      patternParent:
        dataSources:
        "name": "Obtain Capabilities"
        "patternType": "attack-pattern"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        "_type": "Pattern"
        permissionsRequired:
        "_createdAt": 1633310408517
        defenseBypassed:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        tactics:
          1. "resource-development"
        extraData:
        platforms:
          1. "PRE"
        "remoteSupport": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1588"
        "version": "1.0"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "patternId": "T1588"
        "revoked": false
    "occurDate": 1698272139000
    "patternId": "T1588.006"
    "tactic": "resource-development"
  3.
    "_createdAt": 1698329982647
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493451504"
    extraData:
      pattern:
        "version": "2.3"
        "_createdAt": 1633310390294
        defenseBypassed:
        "description": "Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), network device administration and management protocols (like SNMP and Smart Install(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)"
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1190"
        "detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation."
        extraData:
        "remoteSupport": false
        "revoked": false
        "_type": "Pattern"
        "name": "Exploit Public-Facing Application"
        systemRequirements:
        platforms:
          1. "Windows"
          2. "IaaS"
          3. "Network"
          4. "Linux"
          5. "macOS"
          6. "Containers"
        tactics:
          1. "initial-access"
        "_createdBy": "admin@thehive.local"
        "_id": "~45563984"
        dataSources:
          1. "Application Log: Application Log Content"
          2. "Network Traffic: Network Traffic Content"
        "patternId": "T1190"
        "patternType": "attack-pattern"
    "occurDate": 1698272139000
    "patternId": "T1190"
    "tactic": "initial-access"
"source": "rcmkha"
event:
  object:
    "endDate": 1698329985301
    customFields:
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698272139000
        "order": 0
      last-time:
        "date": 1698326378000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "title": "Эксплуатация уязвимостей"
    "impactStatus": "NoImpact"
    "resolutionStatus": "TruePositive"
    "tlp": 2
    "startDate": 1698329952940
    "id": "~1427390592"
    "updatedBy": "zsiem@rcm.lcl"
    "updatedAt": 1698329985347
    tags:
      1. "Sensor:id="310009""
      2. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      3. "Sensor:name="Правительство Республики Саха (Якутия)""
      4. "tlp:amber"
      5. "svo:other"
    "status": "Resolved"
    "pap": 2
    "severity": 2
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-14`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Эксплуатация уязвимостей`

Описание: `Эксплуатация уязвимостей. Целевые порты: 5555`

Отработало на СОА: 
- **`310009`** Правительство Республики Саха (Якутия), Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 01:15:39`**
- Время окончания: **`26.10.2023 16:19:38`**
- **IP из домашней подсети**

1. **`91.201.237.96`**
- **IP из внешней подсети**

1. **`103.178.229.184`**
2. **`103.180.146.2`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009637`**, Сообщение: NCCCI Mirai Possible Scan

"
    "caseId": 14449
    "owner": "zsiem@rcm.lcl"
    permissions:
    "createdBy": "zsiem@rcm.lcl"
    "createdAt": 1698329952965
    "_type": "case"
    "_id": "~1427390592"
    stats:
    "flag": false
  "organisation": "RCM_DFO"
  "objectId": "~1427390592"
  "base": true
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362136"
  "startDate": 1698329985354
  "rootId": "~1427390592"
  "organisationId": "~4136"
  "operation": "update"
  details:
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
    "endDate": 1698329985301
    customFields:
      class-attack:
        "string": "Exploit"
        "order": 0
      first-time:
        "date": 1698272139000
        "order": 0
      last-time:
        "order": 0
        "date": 1698326378000
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
    "resolutionStatus": "TruePositive"
  "objectType": "case"


2023/10/26 14:19:50 	---------------
	EVENTS:
ttp:
  1.
    "patternId": "T1588.006"
    "tactic": "resource-development"
    "_createdAt": 1698330017480
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~935231648"
    extraData:
      pattern:
        "name": "Vulnerabilities"
        platforms:
          1. "PRE"
        systemRequirements:
        permissionsRequired:
        "url": "https://attack.mitre.org/techniques/T1588/006"
        "version": "1.0"
        "_type": "Pattern"
        defenseBypassed:
        "description": "Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004))."
        extraData:
        "patternType": "attack-pattern"
        "revoked": false
        "_createdAt": 1633310543738
        "_id": "~45945024"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the potential use of exploits for vulnerabilities (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "remoteSupport": false
        tactics:
          1. "resource-development"
        "_createdBy": "admin@thehive.local"
        dataSources:
        "patternId": "T1588.006"
      patternParent:
        "name": "Obtain Capabilities"
        platforms:
          1. "PRE"
        systemRequirements:
        "version": "1.0"
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
        dataSources:
        "url": "https://attack.mitre.org/techniques/T1588"
        "_createdAt": 1633310408517
        "patternId": "T1588"
        "patternType": "attack-pattern"
        "revoked": false
        defenseBypassed:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        extraData:
        "remoteSupport": false
        tactics:
          1. "resource-development"
        "_type": "Pattern"
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        permissionsRequired:
    "occurDate": 1698271187000
  2.
    "patternId": "T1588.005"
    "tactic": "resource-development"
    "_createdAt": 1698330017124
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~1754525896"
    extraData:
      pattern:
        "_createdBy": "admin@thehive.local"
        "name": "Exploits"
        systemRequirements:
        "detection": "
Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on behaviors relating to the use of exploits (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        extraData:
        "patternId": "T1588.005"
        platforms:
          1. "PRE"
        "revoked": false
        tactics:
          1. "resource-development"
        "remoteSupport": false
        "_id": "~4747376"
        "_type": "Pattern"
        dataSources:
        "description": "Adversaries may buy, steal, or download exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than developing their own exploits, an adversary may find/modify exploits from online or purchase them from exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying)

In addition to downloading free exploits from the internet, adversaries may purchase exploits from third-party entities. Third-party entities can include technology companies that specialize in exploit development, criminal marketplaces (including exploit kits), or from individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) In addition to purchasing exploits, adversaries may steal and repurpose exploits from third-party entities (including other adversaries).(Citation: TempertonDarkHotel)

An adversary may monitor exploit provider forums to understand the state of existing, as well as newly discovered, exploits. There is usually a delay between when an exploit is discovered and when it is made public. An adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation.

Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004))."
        "patternType": "attack-pattern"
        permissionsRequired:
        "_createdAt": 1633310474490
        defenseBypassed:
        "url": "https://attack.mitre.org/techniques/T1588/005"
        "version": "1.0"
      patternParent:
        "patternType": "attack-pattern"
        "url": "https://attack.mitre.org/techniques/T1588"
        "version": "1.0"
        "_type": "Pattern"
        defenseBypassed:
        extraData:
        "remoteSupport": false
        dataSources:
        "description": "Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle.

In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)"
        permissionsRequired:
        "patternId": "T1588"
        "revoked": false
        systemRequirements:
        "detection": "Much of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on related stages of the adversary lifecycle, such as during Defense Evasion or Command and Control."
        "name": "Obtain Capabilities"
        platforms:
          1. "PRE"
        tactics:
          1. "resource-development"
        "_createdAt": 1633310408517
        "_createdBy": "admin@thehive.local"
        "_id": "~45645904"
    "occurDate": 1698271187000
  3.
    "tactic": "initial-access"
    "_createdAt": 1698330017826
    "_createdBy": "zsiem@rcm.lcl"
    "_id": "~4493467888"
    extraData:
    "occurDate": 1698271187000
    "patternId": "T1190"
"source": "rcmkha"
event:
  details:
    "endDate": 1698330019150
    customFields:
      last-time:
        "date": 1698327208000
        "order": 0
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "order": 0
        "string": "Exploit"
      first-time:
        "date": 1698271187000
        "order": 0
    "resolutionStatus": "TruePositive"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "status": "Resolved"
    "impactStatus": "NoImpact"
  "objectType": "case"
  "objectId": "~935223456"
  "base": true
  "startDate": 1698330019210
  "operation": "update"
  "rootId": "~935223456"
  "requestId": "bbf87fe0943a9ab3:-678f7f85:18a63b039d7:-8000:362164"
  object:
    "severity": 2
    "tlp": 2
    "status": "Resolved"
    "createdBy": "zsiem@rcm.lcl"
    "createdAt": 1698329990758
    "flag": false
    "caseId": 14450
    "title": "Эксплуатация уязвимостей"
    "description": "**Задача переданная из смежной системы: Заслон-Пост-Модерн**

В формате ГЦМ: **`DFO-A-20231026-15`**

Автор задачи: **`kiv`**

Тип: **`snort`**

**Причина, по которой создана задача**

Название: `Эксплуатация уязвимостей`

Описание: `Эксплуатация уязвимостей. Целевые порты: 5555`

Отработало на СОА: 
- **`310078`** Правительство Республики Саха (Якутия), Установлен: Республика Саха (Якутия), Якутск



**Полное описание события IDS:**

- Время начала: **`26.10.2023 00:59:47`**
- Время окончания: **`26.10.2023 16:33:28`**
- **IP из домашней подсети**

1. **`91.207.7.40`**
- **IP из внешней подсети**

1. **`103.178.229.184`**
2. **`103.180.146.2`**


**Сигнатуры на которых отработал анализатор сетевого трафика:**

1. РП: **`99009637`**, Сообщение: NCCCI Mirai Possible Scan

"
    "endDate": 1698330019150
    "updatedAt": 1698330019203
    stats:
    "startDate": 1698329990743
    tags:
      1. "NCIRCC:attack="Попытки эксплуатации уязвимости""
      2. "Sensor:name="Правительство Республики Саха (Якутия)""
      3. "tlp:amber"
      4. "svo:other"
      5. "Sensor:id="310078""
    "pap": 2
    "owner": "zsiem@rcm.lcl"
    customFields:
      ncircc-class-attack:
        "order": 0
        "string": "Попытки эксплуатации уязвимости;attack"
      class-attack:
        "string": "Exploit"
        "order": 0
      first-time:
        "date": 1698271187000
        "order": 0
      last-time:
        "date": 1698327208000
        "order": 0
    permissions:
    "id": "~935223456"
    "impactStatus": "NoImpact"
    "summary": "Сведения о компьютерной атаке доведены до ответственных лиц. Усиления мер информационной защиты на контролируемом объекте не потребовалось."
    "updatedBy": "zsiem@rcm.lcl"
    "resolutionStatus": "TruePositive"
    "_id": "~935223456"
    "_type": "case"
  "organisationId": "~4136"
  "organisation": "RCM_DFO"
observables:
  1.
    "data": "103.178.229.184"
    reports:
    extraData:
    "ioc": true
    "sighted": false
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    "_type": "Observable"
    tags:
      1. "external"
    "startDate": 1698330013986
    "_createdAt": 1698330013986
    "_id": "~1427431552"
    "dataType": "ip"
  2.
    "_createdBy": "zsiem@rcm.lcl"
    "data": "99009637"
    extraData:
    reports:
    "sighted": false
    "tlp": 2
    "_createdAt": 1698330014011
    "dataType": "snort_sid"
    "startDate": 1698330014011
    "_id": "~1508368384"
    "_type": "Observable"
    "ioc": false
    tags:
      1. "snort"
  3.
    "sighted": false
    tags:
      1. "home"
    "_createdAt": 1698330013961
    "_id": "~1427427456"
    "_type": "Observable"
    extraData:
    reports:
    "data": "91.207.7.40"
    "tlp": 2
    "dataType": "ip_home"
    "startDate": 1698330013961
    "_createdBy": "zsiem@rcm.lcl"
    "ioc": false
  4.
    "data": "103.180.146.2"
    "sighted": false
    "ioc": true
    reports:
    "_createdAt": 1698330014030
    "_id": "~1216393400"
    "dataType": "ip"
    "_type": "Observable"
    tags:
      1. "external"
    "tlp": 2
    "_createdBy": "zsiem@rcm.lcl"
    extraData:
    "startDate": 1698330014030


"pattern": {},//именно объект
                "remoteSupport": false,
                "systemRequirements": [],//пока не понятно
                "version": "1.2",
                "defenseBypassed": {},//пока не понятно
                "extraData": {},//