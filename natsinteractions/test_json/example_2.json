2023/09/11 17:10:50 ---------------
EVENTS:
"source": "gcm"
event:
  "rootId": "~69181456624"
  "requestId": "f0d1424003dc82d6:2727b5e0:18a8458e1ee:-8000:16050"
  object:
    "pap": 2
    "status": "Open"
    "createdAt": 1687182973300
    tags:
      1. "Webhook:send="ZK""
      2. "Webhook: send="MISP""
      3. "NCIRCC:incident="Заражение ВПО""
    "impactStatus": "WithImpact"
    "_id": "~69181456624"
    "summary": "ТЕСТ! НЕ ДОБАВЛЯТЬ В ZK"
    stats:
    "id": "~69181456624"
    "tlp": 2
    customFields:
      attack-type:
        "order": 7
        "string": "Распределенная КА"
      external-letter:
        "order": 1
      inner-letter:
        "order": 2
      notification:
      report:
        "order": 6
      class-attack:
        "order": 0
        "string": "Подбор пароля"
      inbox1:
        "order": 4
      misp-event-id:
        "order": 0
        "string": "118097"
      ncircc-class-attack:
        "order": 3
        "string": "Не отправлять в НКЦКИ"
    "startDate": 1687182660000
    "resolutionStatus": "TruePositive"
    "caseId": 32572
    "title": "TEST MISP"
    "description": "[Тестовый кейс для улучшения работы в MISP"
    "severity": 2
    "endDate": 1694441379604
    "createdBy": "d.zablotsky@cloud.gcm"
    "updatedAt": 1694441779477
    "flag": false
    "updatedBy": "d.zablotsky@cloud.gcm"
    "_type": "case"
    permissions:
    "owner": "d.zablotsky@cloud.gcm"
  "organisation": "GCM"
  "operation": "update"
  "objectType": "case"
  "objectId": "~69181456624"
  "organisationId": "~4192"
  details:
    "status": "Open"
  "base": true
  "startDate": 1694441779482
observables:
  1.
    "_id": "~66560999616"
    "data": "39058"
    reports:
    "startDate": 1687943138850
    tags:
    extraData:
    "ignoreSimilarity": false
    "ioc": true
    "message": "snort"
    "sighted": false
    "tlp": 2
    "_createdAt": 1687943138850
    "_createdBy": "d.zablotsky@cloud.gcm"
    "_type": "Observable"
    "dataType": "snort_sid"
  2.
    "message": "url"
    "startDate": 1687943340184
    tags:
    "_createdBy": "d.zablotsky@cloud.gcm"
    extraData:
    "ioc": true
    "_type": "Observable"
    reports:
    "sighted": false
    "tlp": 2
    "_createdAt": 1687943340184
    "_id": "~69919784992"
    "data": "https://www.google.com/search?q=%D0%B3%D1%83%D0%B3%D0%BB+%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4%D1%87%D0%B8%D0%BA"
    "dataType": "url"
    "ignoreSimilarity": false
  3.
    "_createdBy": "d.zablotsky@cloud.gcm"
    "ignoreSimilarity": false
    "message": "filename"
    reports:
    "startDate": 1687943195485
    "dataType": "filename"
    extraData:
    tags:
    "_createdAt": 1687943195485
    "_id": "~68609060960"
    "sighted": false
    "_type": "Observable"
    "data": "SolarWinds.exe"
    "ioc": true
    "tlp": 2
  4.
    tags:
    "tlp": 2
    "_createdBy": "d.zablotsky@cloud.gcm"
    "message": "mail.ru"
    "ignoreSimilarity": false
    "_type": "Observable"
    "data": "kuku@mail.ru"
    "sighted": false
    "startDate": 1687943257918
    extraData:
    "ioc": true
    "dataType": "email-body"
    reports:
    "_createdAt": 1687943257918
    "_id": "~68609069152"
  5.
    "dataType": "phone-number"
    reports:
    "sighted": false
    "startDate": 1687942922738
    "tlp": 2
    "_id": "~68609024096"
    extraData:
    "_createdAt": 1687942922738
    "_type": "Observable"
    "data": "+78412356789"
    tags:
    "_createdBy": "d.zablotsky@cloud.gcm"
    "ignoreSimilarity": false
    "ioc": true
    "message": "телефон"
  6.
    "_createdBy": "d.zablotsky@cloud.gcm"
    "message": "Тест"
    "sighted": false
    tags:
    extraData:
    "ioc": true
    "startDate": 1687942890302
    "_id": "~69510058104"
    attachment:
      "size": 817
      "contentType": "text/plain"
      hashes:
        1. "c29438b04791184d3eba39bdb7cf99560ab62068fee9509d50cf59723c398ac1"
        2. "58861ef4c118cc3270b9871734ee54852a1374e5"
        3. "7c531394dc2f483bc6c6c628c02e0788"
      "id": "c29438b04791184d3eba39bdb7cf99560ab62068fee9509d50cf59723c398ac1"
      "name": "n[n.txt"
    "dataType": "file"
    "_createdAt": 1687942890302
    "_type": "Observable"
    "ignoreSimilarity": false
    reports:
    "tlp": 2
  7.
    "data": "rkhan@flynas.com"
    "ignoreSimilarity": false
    "ioc": false
    "message": ""
    "_createdBy": "d.zablotsky@cloud.gcm"
    extraData:
    "_createdAt": 1688032128244
    "_type": "Observable"
    "dataType": "mail"
    reports:
    "sighted": false
    "startDate": 1688032128244
    "tlp": 2
    "_id": "~69059260416"
    tags:
      1. "misp:Network activity="email-src""
  8.
    "data": "192.168.23.44"
    extraData:
    "startDate": 1694441358901
    "tlp": 2
    "_createdAt": 1694441358901
    "_id": "~78685831176"
    "_type": "Observable"
    "dataType": "ip_home"
    tags:
      1. "misp:External analysis="ip-src""
    "ignoreSimilarity": false
    "ioc": false
    "message": ""
    reports:
    "_createdBy": "d.zablotsky@cloud.gcm"
    "sighted": false
ttp:
  1.
    "occurDate": 1687182720000
    "patternId": "T1007"
    "tactic": "discovery"
    "_createdAt": 1687183011677
    "_createdBy": "d.zablotsky@cloud.gcm"
    "_id": "~65617940704"
    extraData:
      pattern:
        defenseBypassed:
        "version": "1.4"
        "capecUrl": "https://capec.mitre.org/data/definitions/574.html"
        "patternId": "T1007"
        "revoked": false
        tactics:
          1. "discovery"
        dataSources:
          1. "Command: Command Execution"
          2. "Process: OS API Execution"
          3. "Process: Process Creation"
        "description": "Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>.

Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions."
        "detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.

Monitor processes and command-line arguments for actions that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001)."
        "name": "System Service Discovery"
        permissionsRequired:
        platforms:
          1. "Windows"
          2. "macOS"
          3. "Linux"
        "url": "https://attack.mitre.org/techniques/T1007"
        "_id": "~468385824"
        "_createdBy": "architector@33c.rcm"
        "_type": "Pattern"
        "capecId": "CAPEC-574"
        extraData:
        "patternType": "attack-pattern"
        "remoteSupport": false
        systemRequirements:
        "_createdAt": 1616761468774
  2.
    "_id": "~66887692384"
    extraData:
      pattern:
        defenseBypassed:
        "description": "Adversaries may gather information about the victim's identity that can be used during targeting. Information about identities may include a variety of details, including personal data (ex: employee names, email addresses, etc.) as well as sensitive details such as credentials.

Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about users could also be enumerated via other active means (i.e. [Active Scanning](https://attack.mitre.org/techniques/T1595)) such as probing and analyzing responses from authentication services that may reveal valid usernames in a system.(Citation: GrimBlog UsernameEnum) Information about victims may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak)(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks)

Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Valid Accounts](https://attack.mitre.org/techniques/T1078))."
        extraData:
        "patternId": "T1589"
        "patternType": "attack-pattern"
        platforms:
          1. "PRE"
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1589"
        "_createdAt": 1616761466210
        "_createdBy": "architector@33c.rcm"
        "name": "Gather Victim Identity Information"
        "remoteSupport": false
        dataSources:
          1. "Network Traffic: Network Traffic Content"
        "detection": "Monitor for suspicious network traffic that could be indicative of probing for user information, such as large/iterative quantities of authentication requests originating from a single source (especially if the source is known to be associated with an adversary/botnet). Analyzing web metadata may also reveal artifacts that can be attributed to potentially malicious activity, such as referer or user-agent string HTTP/S fields.

Much of this activity may have a very high occurrence and associated false positive rate, as well as potentially taking place outside the visibility of the target organization, making detection difficult for defenders.

Detection efforts may be focused on related stages of the adversary lifecycle, such as during Initial Access."
        permissionsRequired:
        tactics:
          1. "reconnaissance"
        "_id": "~468312096"
        "_type": "Pattern"
        "revoked": false
        "version": "1.2"
    "occurDate": 1687182720000
    "patternId": "T1589"
    "tactic": "reconnaissance"
    "_createdAt": 1687182988776
    "_createdBy": "d.zablotsky@cloud.gcm"
  3.
    "tactic": "initial-access"
    "_createdAt": 1687182998135
    "_createdBy": "d.zablotsky@cloud.gcm"
    "_id": "~69181468912"
    extraData:
      patternParent:
        "patternType": "attack-pattern"
        "remoteSupport": false
        "revoked": false
        systemRequirements:
        "_createdAt": 1616761469133
        "_createdBy": "architector@33c.rcm"
        dataSources:
          1. "Logon Session: Logon Session Creation"
          2. "Logon Session: Logon Session Metadata"
          3. "User Account: User Account Authentication"
        defenseBypassed:
          1. "Firewall"
          2. "Anti-virus"
          3. "Host Intrusion Prevention Systems"
          4. "Network Intrusion Detection System"
          5. "Application Control"
          6. "System Access Controls"
        tactics:
          1. "defense-evasion"
          2. "initial-access"
          3. "persistence"
          4. "privilege-escalation"
        "_id": "~468389920"
        "capecUrl": "https://capec.mitre.org/data/definitions/560.html"
        "detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).

Perform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately."
        "url": "https://attack.mitre.org/techniques/T1078"
        "_type": "Pattern"
        extraData:
        platforms:
          1. "Windows"
          2. "Azure AD"
          3. "Office 365"
          4. "SaaS"
          5. "IaaS"
          6. "Linux"
          7. "macOS"
          8. "Google Workspace"
          9. "Containers"
          10. "Network"
        permissionsRequired:
          1. "User"
          2. "Administrator"
        "version": "2.5"
        "capecId": "CAPEC-560"
        "description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.

In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)

The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)"
        "name": "Valid Accounts"
        "patternId": "T1078"
      pattern:
        "_createdBy": "architector@33c.rcm"
        "_type": "Pattern"
        defenseBypassed:
        extraData:
        "name": "Cloud Accounts"
        "remoteSupport": false
        systemRequirements:
        "url": "https://attack.mitre.org/techniques/T1078/004"
        "description": "Adversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. In some cases, cloud accounts may be federated with traditional identity management system, such as Window Active Directory.(Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying AD Federation)

Compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases. Access to cloud accounts can also be abused to gain Initial Access to a network by abusing a [Trusted Relationship](https://attack.mitre.org/techniques/T1199). Similar to [Domain Accounts](https://attack.mitre.org/techniques/T1078/002), compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment.

Once a cloud account is compromised, an adversary may perform [Account Manipulation](https://attack.mitre.org/techniques/T1098) - for example, by adding [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) - to maintain persistence and potentially escalate their privileges."
        platforms:
          1. "Azure AD"
          2. "Office 365"
          3. "SaaS"
          4. "IaaS"
          5. "Google Workspace"
        "version": "1.4"
        "_id": "~632496328"
        dataSources:
          1. "Logon Session: Logon Session Metadata"
          2. "User Account: User Account Authentication"
          3. "Logon Session: Logon Session Creation"
        "detection": "Monitor the activity of cloud accounts to detect abnormal or malicious behavior, such as accessing information outside of the normal function of the account or account usage at atypical hours."
        "patternId": "T1078.004"
        "patternType": "attack-pattern"
        "revoked": false
        "_createdAt": 1616761470887
        permissionsRequired:
          1. "User"
          2. "Administrator"
        tactics:
          1. "defense-evasion"
          2. "initial-access"
          3. "persistence"
          4. "privilege-escalation"
    "occurDate": 1687182720000
    "patternId": "T1078.004"
  